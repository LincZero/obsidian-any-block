/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __commonJS = (cb, mod) => function __require() {
  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// node_modules/html-to-md/dist/index.js
var require_dist = __commonJS({
  "node_modules/html-to-md/dist/index.js"(exports, module2) {
    !function(t, e) {
      typeof exports === "object" && typeof module2 === "object" ? module2.exports = e() : typeof define === "function" && define.amd ? define([], e) : typeof exports === "object" ? exports.html2md = e() : t.html2md = e();
    }(exports, function() {
      return function(t) {
        var e = {};
        function r(n) {
          if (e[n])
            return e[n].exports;
          var o = e[n] = { i: n, l: false, exports: {} };
          return t[n].call(o.exports, o, o.exports, r), o.l = true, o.exports;
        }
        return r.m = t, r.c = e, r.d = function(t2, e2, n) {
          r.o(t2, e2) || Object.defineProperty(t2, e2, { enumerable: true, get: n });
        }, r.r = function(t2) {
          typeof Symbol !== "undefined" && Symbol.toStringTag && Object.defineProperty(t2, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t2, "__esModule", { value: true });
        }, r.t = function(t2, e2) {
          if (1 & e2 && (t2 = r(t2)), 8 & e2)
            return t2;
          if (4 & e2 && typeof t2 === "object" && t2 && t2.__esModule)
            return t2;
          var n = /* @__PURE__ */ Object.create(null);
          if (r.r(n), Object.defineProperty(n, "default", { enumerable: true, value: t2 }), 2 & e2 && typeof t2 != "string")
            for (var o in t2)
              r.d(n, o, function(e3) {
                return t2[e3];
              }.bind(null, o));
          return n;
        }, r.n = function(t2) {
          var e2 = t2 && t2.__esModule ? function() {
            return t2.default;
          } : function() {
            return t2;
          };
          return r.d(e2, "a", e2), e2;
        }, r.o = function(t2, e2) {
          return Object.prototype.hasOwnProperty.call(t2, e2);
        }, r.p = "", r(r.s = 45);
      }([function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(1), o = r(9), i = r(12), a = r(6), c = r(2), u = function() {
          function t2(t3, e2, r2) {
            var n2 = r2 === void 0 ? {} : r2, o2 = n2.keepSpace, i2 = o2 !== void 0 && o2, a2 = n2.prevTagName, c2 = a2 === void 0 ? "" : a2, u2 = n2.nextTagName, s = u2 === void 0 ? "" : u2, l = n2.prevTagStr, p = l === void 0 ? "" : l, f = n2.nextTagStr, h = f === void 0 ? "" : f, d = n2.parentTag, _ = d === void 0 ? "" : d, y = n2.isFirstSubTag, v = y === void 0 || y, g = n2.calcLeading, b = g !== void 0 && g, m = n2.leadingSpace, O = m === void 0 ? "" : m, T = n2.layer, S = T === void 0 ? 1 : T, x = n2.noWrap, j = x !== void 0 && x, w = n2.match, P = w === void 0 ? null : w, M = n2.indentSpace, C = M === void 0 ? "" : M, N = n2.language, E = N === void 0 ? "" : N, L = n2.count, k = L === void 0 ? 1 : L, A = n2.tableColumnCount, V = A === void 0 ? 0 : A, W = n2.noExtraLine, R = W !== void 0 && W, I = n2.inTable, H = I !== void 0 && I;
            if (this.tagName = e2, this.rawStr = t3, this.parentTag = _, this.prevTagName = c2, this.nextTagName = s, this.prevTagStr = p, this.nextTagStr = h, this.isFirstSubTag = v, this.calcLeading = b, this.leadingSpace = O, this.layer = S, this.noWrap = j, this.match = P, this.indentSpace = C, this.language = E, this.count = k, this.inTable = H, this.tableColumnCount = V, this.noExtraLine = R, this.keepSpace = i2, !this.__detectStr__(t3, this.tagName))
              return this.attrs = {}, void (this.innerHTML = "");
            var q = this.__fetchTagAttrAndInnerHTML__(t3), F = q.attr, G = q.innerHTML;
            this.attrs = F, this.innerHTML = G;
          }
          return t2.prototype.__detectStr__ = function(t3, e2) {
            if (t3[0] !== "<")
              return console.error("Not a valid tag, current tag name: ".concat(this.tagName, ", tag content: ").concat(t3)), false;
            for (var r2 = "", n2 = false, o2 = 1; o2 < t3.length && t3[o2] !== ">"; o2++)
              !n2 && /(\s|\/)/.test(t3[o2]) && (n2 = true), n2 || (r2 += t3[o2]);
            return r2 === e2 || (console.warn("Tag is not match tagName, tagName in str is " + r2 + ", which tagName passed from parent is " + e2), false);
          }, t2.prototype.__fetchTagAttrAndInnerHTML__ = function(t3) {
            for (var e2 = "", r2 = 1; r2 < t3.length && t3[r2] !== ">"; r2++)
              e2 += t3[r2];
            for (var o2 = t3.slice(r2 + 1), i2 = "", a2 = -1, c2 = o2.length - 1; c2 >= 0; c2--)
              if ((i2 = o2[c2] + i2).startsWith("</")) {
                i2.startsWith("</" + this.tagName + ">") && (a2 = c2);
                break;
              }
            a2 === -1 && (0, n.isSelfClosing)(this.tagName) && console.warn("There detect a self close tag, which name is:", this.tagName);
            var u2 = (0, n.getTagAttributes)(e2);
            return this.tagName && delete u2[this.tagName], { attr: u2, innerHTML: o2.slice(0, a2) };
          }, t2.prototype.__onlyLeadingSpace__ = function(t3) {
            t3 = t3.trim();
            for (var e2 = 0; e2 < t3.length; e2++)
              if (t3[e2] !== i.SINGLE)
                return false;
            return true;
          }, t2.prototype.__isEmpty__ = function(t3) {
            return !this.keepSpace && (t3 === "" && this.tagName !== "td" || this.calcLeading && this.__onlyLeadingSpace__(t3));
          }, t2.prototype.getValidSubTagName = function(t3) {
            return t3;
          }, t2.prototype.beforeParse = function() {
            var t3 = c.default.get().tagListener;
            if (t3) {
              var e2 = t3(this.tagName, { parentTag: this.parentTag, prevTagName: this.prevTagName, nextTagName: this.nextTagName, isFirstSubTag: this.isFirstSubTag, attrs: this.attrs, innerHTML: this.innerHTML, language: this.language, match: this.match, isSelfClosing: false }), r2 = e2.attrs, n2 = e2.language, o2 = e2.match;
              this.attrs = r2, typeof n2 === "string" && (this.language = n2), typeof o2 !== "undefined" && (this.match = o2);
            }
            return "";
          }, t2.prototype.parseValidSubTag = function(t3, e2, r2) {
            return new ((0, n.getTagConstructor)(e2))(t3, e2, r2).exec();
          }, t2.prototype.parseOnlyString = function(t3, e2, r2) {
            return new o.default(t3, e2, r2).exec();
          }, t2.prototype.afterParsed = function(t3) {
            return t3;
          }, t2.prototype.slim = function(t3) {
            return this.keepSpace ? t3 : t3.trim();
          }, t2.prototype.beforeMergeSpace = function(t3) {
            return t3;
          }, t2.prototype.mergeSpace = function(t3, e2, r2) {
            return this.keepSpace && this.tagName !== "pre" ? t3.endsWith("\n") ? t3 : t3 + r2.replace(/\n+/g, "\n") : e2 + t3 + r2;
          }, t2.prototype.afterMergeSpace = function(t3) {
            return t3;
          }, t2.prototype.beforeReturn = function(t3) {
            return t3;
          }, t2.prototype.exec = function(t3, e2) {
            t3 === void 0 && (t3 = ""), e2 === void 0 && (e2 = "");
            for (var r2 = this.beforeParse(), o2 = (0, n.generateGetNextValidTag)(this.innerHTML), i2 = o2(), c2 = i2[0], u2 = i2[1], s = null; u2 !== ""; ) {
              var l = o2(), p = l[0], f = l[1], h = { parentTag: this.tagName, nextTagName: p, nextTagStr: f, prevTagName: s, prevTagStr: r2, leadingSpace: this.leadingSpace, layer: this.layer, keepSpace: this.keepSpace, inTable: this.inTable }, d = void 0;
              d = c2 != null ? this.parseValidSubTag(u2, c2, h) : this.parseOnlyString(u2, c2, h);
              var _ = this.getValidSubTagName(c2);
              c2 = p, u2 = f, _ == null && this.__isEmpty__(d) || (s = _, this.isFirstSubTag = false, r2 += d);
            }
            return r2 = this.afterParsed(r2), r2 = this.slim(r2), this.__isEmpty__(r2) ? "" : (r2 = this.beforeMergeSpace(r2), !this.noExtraLine && (0, a.default)(this.tagName) && this.prevTagName && !r2.startsWith("\n") && !(0, a.default)(this.prevTagName) && this.parentTag && (t3 = "\n\n"), r2 = this.mergeSpace(r2, t3, e2), this.noWrap && !this.keepSpace && (r2 = r2.replace(/\s+/g, " ")), r2 = this.afterMergeSpace(r2), r2 = this.beforeReturn(r2));
          }, t2;
        }();
        e.default = u;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.shouldRenderRawInside = e.isIndependentTag = e.clearComment = e.getLanguage = e.getTableAlign = e.getTagAttributes = e.isSelfClosing = e.generateGetNextValidTag = e.getTagConstructor = e.getRealTagName = e.unescapeStr = e.extraEscape = void 0;
        var n = r(46);
        Object.defineProperty(e, "extraEscape", { enumerable: true, get: function() {
          return n.extraEscape;
        } }), Object.defineProperty(e, "unescapeStr", { enumerable: true, get: function() {
          return n.unescapeStr;
        } });
        var o = r(47);
        e.generateGetNextValidTag = o.default;
        var i = r(48);
        e.getTagConstructor = i.default;
        var a = r(11);
        e.isSelfClosing = a.default;
        var c = r(51);
        e.getTagAttributes = c.default;
        var u = r(52);
        e.getLanguage = u.default;
        var s = r(53);
        e.clearComment = s.default;
        var l = r(17);
        e.getRealTagName = l.default;
        var p = r(6);
        e.isIndependentTag = p.default;
        var f = r(54);
        e.getTableAlign = f.default;
        var h = r(55);
        e.shouldRenderRawInside = h.default;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = function() {
          function t2(t3) {
            var e2 = t3 === void 0 ? {} : t3, r2 = e2.skipTags, n2 = r2 === void 0 ? [] : r2, o2 = e2.emptyTags, i2 = o2 === void 0 ? [] : o2, a = e2.ignoreTags, c = a === void 0 ? [] : a, u = e2.aliasTags, s = u === void 0 ? {} : u, l = e2.renderCustomTags, p = l === void 0 || l, f = e2.tagListener, h = f === void 0 ? function(t4, e3) {
              return e3;
            } : f;
            this.options = { skipTags: n2, emptyTags: i2, ignoreTags: c, aliasTags: s, renderCustomTags: p, tagListener: h };
          }
          return t2.prototype.get = function() {
            return this.options;
          }, t2.prototype.clear = function() {
            this.options = {};
          }, t2.prototype.set = function(t3, e2) {
            var r2 = this;
            t3 && Object.prototype.toString.call(t3) === "[object Object]" && Object.keys(t3).forEach(function(n2) {
              e2 ? r2.options[n2] = t3[n2] : function(t4, e3, r3) {
                if (!(r3 in t4))
                  return void (t4[r3] = e3[r3]);
                var n3 = Array.isArray(t4[r3]), o2 = Object.prototype.toString.call(t4[r3]) === "[object Object]";
                t4[r3] = n3 ? t4[r3].concat(e3[r3]) : o2 ? Object.assign(t4[r3], e3[r3]) : e3[r3];
              }(r2.options, t3, n2);
            });
          }, t2.prototype.reset = function() {
            this.options = JSON.parse(JSON.stringify(o)), this.options.tagListener = function(t3, e2) {
              return e2;
            };
          }, t2;
        }();
        var o = { ignoreTags: ["", "style", "head", "!doctype", "form", "svg", "noscript", "script", "meta"], skipTags: ["div", "html", "body", "nav", "section", "footer", "main", "aside", "article", "header"], emptyTags: [], aliasTags: { figure: "p", dl: "p", dd: "p", dt: "p", figcaption: "p" }, renderCustomTags: true }, i = new n();
        i.reset(), e.default = i;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h1");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "#", n2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return this.match + " " + t3;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 || (e3 = "\n"), r2 || (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(1), o = r(2), i = function() {
          function t2(t3, e2, r2) {
            var n2 = r2 === void 0 ? {} : r2, o2 = n2.parentTag, i2 = o2 === void 0 ? "" : o2, a = n2.leadingSpace, c = a === void 0 ? "" : a, u = n2.layer, s = u === void 0 ? 1 : u, l = n2.isFirstSubTag, p = l !== void 0 && l, f = n2.inTable, h = f !== void 0 && f, d = n2.match, _ = d === void 0 ? null : d, y = n2.prevTagName, v = y === void 0 ? "" : y, g = n2.nextTagName, b = g === void 0 ? "" : g;
            if (this.tagName = e2, this.rawStr = t3, this.parentTag = i2, this.isFirstSubTag = p, this.prevTagName = v, this.nextTagName = b, this.leadingSpace = c, this.layer = s, this.innerHTML = "", this.match = _, this.inTable = h, this.__detectStr__(t3, this.tagName)) {
              var m = this.__fetchTagAttr__(t3).attr;
              this.attrs = m;
            } else
              this.attrs = {};
          }
          return t2.prototype.__detectStr__ = function(t3, e2) {
            if (t3[0] !== "<")
              return console.error("Not a valid tag, current tag name: ".concat(this.tagName, ", tag content: ").concat(t3)), false;
            for (var r2 = "", n2 = false, o2 = 1; o2 < t3.length && t3[o2] !== ">"; o2++)
              !n2 && /(\s|\/)/.test(t3[o2]) && (n2 = true), n2 || (r2 += t3[o2]);
            return r2 === e2 || (console.warn("Tag is not match tagName, tagName in str is " + r2 + ", which tagName passed from parent is " + e2), false);
          }, t2.prototype.__fetchTagAttr__ = function(t3) {
            for (var e2 = "", r2 = 1; r2 < t3.length && t3[r2] !== ">"; r2++)
              e2 += t3[r2];
            return { attr: (0, n.getTagAttributes)(e2) };
          }, t2.prototype.beforeParse = function() {
            var t3 = o.default.get().tagListener;
            if (t3) {
              var e2 = t3(this.tagName, { parentTag: this.parentTag, prevTagName: this.prevTagName, nextTagName: this.nextTagName, isFirstSubTag: this.isFirstSubTag, attrs: this.attrs, innerHTML: this.innerHTML, match: this.match, isSelfClosing: true }), r2 = e2.attrs, n2 = e2.match;
              this.attrs = r2, this.match = n2;
            }
            return "";
          }, t2.prototype.beforeMergeSpace = function(t3) {
            return t3;
          }, t2.prototype.afterMergeSpace = function(t3) {
            return t3;
          }, t2.prototype.beforeReturn = function(t3) {
            return t3;
          }, t2.prototype.exec = function(t3, e2) {
            t3 === void 0 && (t3 = ""), e2 === void 0 && (e2 = "");
            var r2 = this.beforeParse();
            return r2 = t3 + (r2 = this.beforeMergeSpace(r2)) + e2, r2 = this.afterMergeSpace(r2), r2 = this.beforeReturn(r2);
          }, t2;
        }();
        e.default = i;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = function() {
          function t2() {
          }
          return t2.prototype.exec = function() {
            return "";
          }, t2;
        }();
        e.default = n;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(17), o = { html: true, body: true, p: true, div: true, pre: true, section: true, blockquote: true, aside: true, li: true, ul: true, ol: true, form: true, hr: true, h1: true, h2: true, h3: true, h4: true, h5: true, h6: true, dl: true, dd: true, dt: true, br: true };
        e.default = function(t2) {
          if (!t2)
            return false;
          var e2 = (0, n.default)(t2);
          return !!e2 && !!o[e2];
        };
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true }), e.__EmptySelfClose__ = e.__Empty__ = void 0;
        var i = r(0), a = r(4), c = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "__empty__"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.slim = function(t3) {
            return t3;
          }, e2.prototype.parseValidSubTag = function(t3, r2, n2) {
            return new e2(t3, r2, o({}, n2)).exec();
          }, e2.prototype.parseOnlyString = function(t3, e3, r2) {
            return t3;
          }, e2.prototype.exec = function() {
            return t2.prototype.exec.call(this, "", "");
          }, e2;
        }(i.default);
        e.__Empty__ = c;
        var u = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "__emptyselfclose__");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.tagName = r2, n2;
          }
          return n(e2, t2), e2.prototype.exec = function() {
            return t2.prototype.exec.call(this, "", "");
          }, e2;
        }(a.default);
        e.__EmptySelfClose__ = u;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true }), e.__SkipSelfClose__ = e.__Skip__ = void 0;
        var o = r(0), i = r(4), a = r(1), c = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "__skip__");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.noNeedWrap = ["td", "th"], o2;
          }
          return n(e2, t2), e2.prototype.exec = function() {
            var e3 = (0, a.isIndependentTag)((0, a.getRealTagName)(this.tagName)) && (!this.parentTag || !this.noNeedWrap.includes(this.parentTag)), r2 = e3 ? "\n" : "", n2 = e3 ? "\n" : "";
            return t2.prototype.exec.call(this, r2, n2);
          }, e2;
        }(o.default);
        e.__Skip__ = c;
        var u = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "__skipselfclose__"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function() {
            return "";
          }, e2;
        }(i.default);
        e.__SkipSelfClose__ = u;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(1), o = r(6), i = function() {
          function t2(t3, e2, r2) {
            e2 === void 0 && (e2 = "__nomatch__");
            var n2 = r2 === void 0 ? {} : r2, o2 = n2.keepSpace, i2 = o2 !== void 0 && o2, a = n2.prevTagName, c = a === void 0 ? "" : a, u = n2.nextTagName, s = u === void 0 ? "" : u, l = n2.parentTag, p = l === void 0 ? "" : l, f = n2.calcLeading, h = f !== void 0 && f, d = n2.layer, _ = d === void 0 ? 1 : d, y = n2.leadingSpace, v = y === void 0 ? "" : y, g = n2.inTable, b = g !== void 0 && g;
            this.tagName = e2, this.nextTagName = s, this.prevTagName = c, this.parentTag = p, this.keepSpace = i2, this.calcLeading = h, this.leadingSpace = v, this.layer = _, this.rawStr = t3, this.inTable = b;
          }
          return t2.prototype.slim = function(t3) {
            if (this.keepSpace)
              return t3;
            var e2 = t3.replace(/\s+/g, " ");
            return (0, o.default)(this.prevTagName) && (e2 = e2.trimLeft()), (0, o.default)(this.nextTagName) && (e2 = e2.trimRight()), e2;
          }, t2.prototype.beforeReturn = function(t3) {
            if (this.keepSpace)
              return t3;
            if (this.calcLeading)
              return this.leadingSpace + (0, n.extraEscape)(t3);
            var e2 = (0, n.extraEscape)(t3);
            return this.inTable && (e2 = e2.replace(/\|/g, "\\|")), e2;
          }, t2.prototype.exec = function() {
            var t3 = this.rawStr;
            return t3 = this.slim(t3), t3 = this.beforeReturn(t3);
          }, t2;
        }();
        e.default = i;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true }), e.__NoMatchSelfClose__ = e.__NoMatch__ = void 0;
        var o = r(0), i = r(4), a = function(t2) {
          function e2(e3, r2) {
            return r2 === void 0 && (r2 = "__nomatch__"), t2.call(this, e3, r2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return "<".concat(this.tagName, ">").concat(t3, "</").concat(this.tagName, ">");
          }, e2.prototype.exec = function() {
            return t2.prototype.exec.call(this, "", "");
          }, e2;
        }(o.default);
        e.__NoMatch__ = a;
        var c = function(t2) {
          function e2(e3, r2) {
            return r2 === void 0 && (r2 = "__nomatchselfclose__"), t2.call(this, e3, r2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function() {
            return "<".concat(this.tagName, " />");
          }, e2;
        }(i.default);
        e.__NoMatchSelfClose__ = c;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = { img: true, hr: true, input: true, br: true, meta: true, link: true, "!doctype": true, base: true, col: true, area: true, param: true, object: true, embed: true, keygen: true, source: true };
        e.default = function(t2) {
          return t2 != null && !!n[t2.toLowerCase()];
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.TRIPLE = e.DOUBLE = e.SINGLE = void 0;
        e.SINGLE = "\u2608";
        e.DOUBLE = "\u2608\u2608";
        e.TRIPLE = "\u2608\u2608\u2608";
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "strong");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.layer = 1, o2.match = o2.match || "**", o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return this.match + t3 + this.match;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), this.match != null && this.prevTagStr && !this.prevTagStr.endsWith("\\" + this.match[0]) && this.prevTagStr.endsWith(this.match[0]) && (e3 = " "), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "del");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = n2.match || "~~", n2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return this.match + t3 + this.match;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "em");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.match = o2.match || "*", o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return this.match + t3 + this.match;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), this.parentTag === "strong" && this.nextTagStr && (r2 = " "), this.match != null && this.prevTagStr && !this.prevTagStr.endsWith("\\" + this.match) && this.prevTagStr.endsWith(this.match) && (e3 = " "), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "th");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.tagName = r2, o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return t3 + "|";
          }, e2.prototype.parseValidSubTag = function(e3, r2, n2) {
            return r2 === "ul" || r2 === "ol" || r2 === "table" || r2 === "pre" ? e3.replace(/([\n\r])/g, "") : t2.prototype.parseValidSubTag.call(this, e3, r2, n2);
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(2);
        e.default = function(t2) {
          if (!t2)
            return t2;
          var e2 = n.default.get().aliasTags;
          return (e2 === null || e2 === void 0 ? void 0 : e2[t2]) != null ? e2[t2] : t2;
        };
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "a"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            var e3 = this.attrs, r2 = e3.href, n2 = e3.title, o2 = r2 || "";
            return n2 ? "[".concat(t3, "](").concat(o2, ' "').concat(n2, '")') : "[".concat(t3, "](").concat(o2, ")");
          }, e2.prototype.parseOnlyString = function(e3, r2, n2) {
            return this.parentTag === "tbody" || this.parentTag === "thead" ? e3 : t2.prototype.parseOnlyString.call(this, e3, r2, n2);
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "b"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(13).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(6), a = r(0), c = r(1), u = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "blockquote");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.match = o2.match || ">", o2.fillPerLine = o2.fillPerLine.bind(o2), o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            if (t3.trim() === "")
              return "";
            var e3 = this.match + " " + t3;
            return this.calcLeading ? this.leadingSpace + e3 : e3;
          }, e2.prototype.afterMergeSpace = function(t3) {
            for (var e3 = this, r2 = t3.split("\n"), n2 = r2.length - 1; n2 >= 0; n2--)
              n2 < r2.length - 1 && r2[n2].trim() === ">" && r2[n2 + 1].trim() === ">" && r2.splice(n2, 1);
            return (r2 = r2.map(function(t4) {
              return t4 === "" ? "" : e3.fillPerLine(t4);
            })).join("\n");
          }, e2.prototype.beforeReturn = function(t3) {
            return t3.replace("\n\n", "\n");
          }, e2.prototype.fillPerLine = function(t3) {
            var e3 = ">";
            if (this.calcLeading && (e3 = this.leadingSpace + ">"), !t3.startsWith(e3)) {
              var r2 = this.match + " " + t3;
              return this.calcLeading ? this.leadingSpace + r2 : r2;
            }
            return t3;
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            var n2;
            e3 === "blockquote" ? n2 = new ((0, c.getTagConstructor)(e3))(t3, e3, o(o({}, r2), { calcLeading: this.calcLeading, match: this.match + ">", noExtraLine: true })) : n2 = new ((0, c.getTagConstructor)(e3))(t3, e3, o(o({}, r2), { noExtraLine: true }));
            var a2 = n2.exec(), u2 = "";
            this.calcLeading && (u2 = this.leadingSpace);
            var s = (0, i.default)(r2.prevTagName) && r2.prevTagName !== "br", l = (0, i.default)(r2.nextTagName) && r2.nextTagName !== "br", p = (0, i.default)(e3) && e3 !== "br";
            return this.isFirstSubTag ? a2.trimLeft().replace(u2, "") : p ? (a2 = u2 + this.match + a2, s || (a2 = "\n" + a2), !l && r2.nextTagStr && r2.nextTagStr.trim() && (a2 += this.match + "\n"), a2) : s ? u2 + this.match + "\n" + a2 : a2;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(a.default);
        e.default = u;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "b"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function(t3, e3) {
            return e3 === void 0 && (e3 = "\n"), this.inTable ? "" : "  " + e3;
          }, e2;
        }(r(4).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(0), a = r(1), c = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "code");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.match = o2.match == null ? "`" : o2.match, o2.noWrap = o2.match === "`", o2.layer = 1, o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            var e3, r2;
            return this.match !== "" && this.match !== "`" ? (e3 = this.match + " ", r2 = " " + this.match) : (e3 = this.match, r2 = this.match), e3 + t3 + r2;
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            return e3 === "pre" ? new ((0, a.getTagConstructor)(e3))(t3, e3, o(o({}, r2), { language: "", match: "" })).exec("", "\n") : new ((0, a.getTagConstructor)(e3))(t3, e3, o(o({}, r2), { keepSpace: this.keepSpace, noWrap: this.noWrap })).exec("", "");
          }, e2.prototype.parseOnlyString = function(t3) {
            if (this.match !== "" && t3) {
              var e3 = 1;
              (t3.startsWith("`") || t3.endsWith("`")) && (e3 = 2, (t3.startsWith("``") || t3.endsWith("``")) && (e3 = 3)), this.match = "`".repeat(e3);
            }
            return (0, a.unescapeStr)(t3);
          }, e2.prototype.slim = function(t3) {
            return this.keepSpace ? t3 : t3.trim();
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(i.default);
        e.default = c;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h1");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "#", n2;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(3).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h2");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "##", n2;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(3).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h3");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "###", n2;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(3).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h4");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "####", n2;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(3).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h5");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "#####", n2;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(3).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = "h6");
            var n2 = t2.call(this, e3, r2) || this;
            return n2.match = "######", n2;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(3).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "hr");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.match = "---", o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function() {
            return this.leadingSpace + this.match;
          }, e2.prototype.beforeReturn = function(t3) {
            return t3.replace(/^(?:\n\s*)/, "\n\n").replace(/(?:\n\s*)$/, "\n\n"), t3;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(4).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "i"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(15).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "img"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function() {
            var t3 = this.attrs, e3 = t3.src, r2 = t3.alt;
            return r2 || (r2 = ""), e3 || (e3 = ""), "![".concat(r2, "](").concat(e3, ")");
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(4).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "input"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function() {
            var t3 = this.attrs, e3 = t3.type, r2 = t3.checked;
            return this.parentTag === "li" && e3 === "checkbox" ? r2 != null ? "[x] " : "[ ] " : "";
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(4).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(0), a = r(1), c = r(6), u = r(12), s = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "li");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.match = o2.match || "*", o2.extraGap = "", o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return this.extraGap + this.leadingSpace + this.match + " " + t3;
          }, e2.prototype.__calcNextLeading__ = function() {
            var t3, e3, r2;
            return ((t3 = this.match) === null || t3 === void 0 ? void 0 : t3.length) === 1 ? u.DOUBLE : ((e3 = this.match) === null || e3 === void 0 ? void 0 : e3.length) === 2 ? u.TRIPLE : ((r2 = this.match) === null || r2 === void 0 ? void 0 : r2.length) === 3 ? u.DOUBLE : u.TRIPLE + u.DOUBLE;
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            var n2 = (0, a.getTagConstructor)(e3), i2 = this.__calcNextLeading__(), c2 = new n2(t3, e3, o(o({}, r2), { calcLeading: true, leadingSpace: this.leadingSpace + i2, layer: this.layer + 1 })).exec();
            return e3 === "p" && (this.extraGap = "\n"), this.isFirstSubTag ? c2.trimLeft().replace(this.leadingSpace + i2, "") : c2;
          }, e2.prototype.parseOnlyString = function(e3, r2, n2) {
            var i2 = false;
            (0, c.default)(n2.prevTagName) && (i2 = true);
            var a2 = this.__calcNextLeading__(), u2 = t2.prototype.parseOnlyString.call(this, e3, r2, o(o({}, n2), { calcLeading: i2, leadingSpace: this.leadingSpace + a2, layer: this.layer + 1 }));
            return this.isFirstSubTag ? u2.replace(this.leadingSpace + a2, "") : u2;
          }, e2.prototype.beforeReturn = function(e3) {
            return t2.prototype.beforeReturn.call(this, e3);
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(i.default);
        e.default = s;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(0), a = r(5), c = r(1), u = r(2), s = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "ol");
            var o2, i2 = this;
            i2 = t2.call(this, e3, r2, n2) || this;
            var a2 = parseInt((o2 = i2 === null || i2 === void 0 ? void 0 : i2.attrs) === null || o2 === void 0 ? void 0 : o2.start, 10);
            return i2.count = isNaN(a2) ? 1 : a2, i2;
          }
          return n(e2, t2), e2.prototype.__isValidSubTag__ = function(t3) {
            if (!t3)
              return false;
            var e3 = u.default.get().aliasTags, r2 = (0, c.getTagConstructor)(t3);
            return t3 === "li" || (e3 === null || e3 === void 0 ? void 0 : e3[t3]) == "li" || r2 === a.default;
          }, e2.prototype.getValidSubTagName = function(t3) {
            return t3 && this.__isValidSubTag__(t3) ? t3 : null;
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            var n2 = (0, c.getTagConstructor)(e3);
            if (this.__isValidSubTag__(e3)) {
              var i2 = this.count + ".", a2 = new n2(t3, e3, o(o({}, r2), { calcLeading: true, leadingSpace: this.leadingSpace, layer: this.layer, match: i2 }));
              return this.count++, a2.exec("", "\n");
            }
            return console.error("Should not have tags except <li> inside ol, current tag is " + e3 + ", current tagStr is" + t3), "";
          }, e2.prototype.parseOnlyString = function() {
            return "";
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(i.default);
        e.default = s;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "p"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return this.calcLeading ? this.leadingSpace + t3 : t3;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), this.prevTagName || !this.prevTagStr || this.prevTagStr.endsWith("\n") || (e3 = "\n\n"), this.nextTagName || !this.nextTagStr || this.nextTagStr.startsWith("\n") || (r2 = "\n\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(0), a = r(7), c = r(1), u = r(12), s = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "pre");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.indentSpace = u.DOUBLE + u.DOUBLE, o2.isIndent = o2.innerHTML.includes("```"), o2.match = o2.isIndent ? "" : "```", o2.language = o2.language || (0, c.getLanguage)(e3), o2.keepSpace = true, o2;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            var e3 = this.isIndent || this.parentTag === "code" ? "" : this.match + this.language + "\n", r2 = "";
            return t3.endsWith("\n") || (r2 = "\n"), e3 + t3 + (this.isIndent || this.parentTag === "code" ? "" : r2 + this.match);
          }, e2.prototype.fillPerLine = function(t3) {
            var e3 = "";
            return this.calcLeading && (e3 = this.leadingSpace), this.isIndent ? e3 + this.indentSpace + t3 : e3 + t3;
          }, e2.prototype.afterMergeSpace = function(t3) {
            var e3 = this, r2 = t3.split("\n");
            return (r2 = r2.map(function(t4) {
              return t4 === "" ? "" : e3.fillPerLine(t4);
            })).join("\n");
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            if (e3 === "code")
              return new ((0, c.getTagConstructor)(e3))(t3, e3, o(o({}, r2), { match: "", language: this.language, keepSpace: true })).exec("", "");
            return ((0, c.isSelfClosing)(e3) ? new a.__EmptySelfClose__(t3, e3) : new a.__Empty__(t3, e3, o(o({}, r2), { keepSpace: true }))).exec();
          }, e2.prototype.parseOnlyString = function(t3) {
            return t3;
          }, e2.prototype.slim = function(t3) {
            return t3;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(i.default);
        e.default = s;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2) {
            return r2 === void 0 && (r2 = "s"), t2.call(this, e3, r2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(14).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "span"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(0), a = r(1);
        var c = function(t2) {
          function e2(e3, r2, n2) {
            r2 === void 0 && (r2 = "table");
            var o2 = t2.call(this, e3, r2, n2) || this;
            return o2.exist_thead = false, o2.exist_tbody = false, o2.empty_tbody = true, o2.tableColumnCount = function(t3) {
              for (var e4 = "", r3 = 0; r3 < t3.length && !e4.endsWith("</tr>"); r3++)
                e4 += t3[r3];
              return Math.max(e4.split("</td>").length - 1, e4.split("</th>").length - 1);
            }(o2.innerHTML), o2;
          }
          return n(e2, t2), e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            return e3 === "thead" && (this.exist_thead = true), e3 === "tbody" && (this.exist_tbody = true, this.empty_tbody = false), e3 === "tr" && (this.empty_tbody = false), new ((0, a.getTagConstructor)(e3))(t3, e3, o(o({}, r2), { tableColumnCount: this.tableColumnCount, inTable: true })).exec("", "\n");
          }, e2.prototype.parseOnlyString = function() {
            return "";
          }, e2.prototype.beforeReturn = function(t3) {
            if (!this.exist_thead && !this.exist_tbody && this.empty_tbody)
              return "";
            if (this.tableColumnCount === 0)
              return "";
            if (!this.exist_tbody) {
              for (var e3 = (0, a.getTableAlign)(this.innerHTML, this.tableColumnCount), r2 = "|", n2 = 0; n2 < e3.length; n2++)
                r2 += e3[n2];
              t3 = this.empty_tbody ? t3 + r2 + "\n" : r2 + "" + t3;
            }
            return this.exist_thead || (t3 = "\n" + "|".repeat(this.tableColumnCount + 1) + (t3.startsWith("\n") ? "" : "\n") + t3), t3;
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(i.default);
        e.default = c;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = r(0), i = r(1), a = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "tbody"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            for (var e3 = (0, i.getTableAlign)(this.innerHTML, this.tableColumnCount), r2 = "|", n2 = 0; n2 < e3.length; n2++)
              r2 += e3[n2];
            return r2 + "\n" + t3;
          }, e2.prototype.parseOnlyString = function() {
            return "";
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(o.default);
        e.default = a;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "td"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.parseValidSubTag = function(e3, r2, n2) {
            return r2 === "ul" || r2 === "ol" || r2 === "table" || r2 === "pre" ? e3.replace(/([\n\r])/g, "") : t2.prototype.parseValidSubTag.call(this, e3, r2, n2);
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(16).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "thead"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = ""), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(r(0).default);
        e.default = o;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }();
        Object.defineProperty(e, "__esModule", { value: true });
        var o = r(0), i = r(5), a = r(1), c = r(2), u = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "tr"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.beforeMergeSpace = function(t3) {
            return "|" + t3;
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            var n2 = c.default.get().aliasTags, o2 = (0, a.getTagConstructor)(e3);
            return e3 !== "td" && e3 !== "th" && (n2 === null || n2 === void 0 ? void 0 : n2[e3]) !== "td" && (n2 === null || n2 === void 0 ? void 0 : n2[e3]) !== "th" && o2 !== i.default ? (console.error("Should not have tags except <td> or <th> inside <tr>, current tag is ".concat(e3, " have been ignore.")), "") : new o2(t3, e3, r2).exec("", "");
          }, e2.prototype.parseOnlyString = function() {
            return "";
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = ""), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(o.default);
        e.default = u;
      }, function(t, e, r) {
        "use strict";
        var n = this && this.__extends || function() {
          var t2 = function(e2, r2) {
            return (t2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t3, e3) {
              t3.__proto__ = e3;
            } || function(t3, e3) {
              for (var r3 in e3)
                Object.prototype.hasOwnProperty.call(e3, r3) && (t3[r3] = e3[r3]);
            })(e2, r2);
          };
          return function(e2, r2) {
            if (typeof r2 !== "function" && r2 !== null)
              throw new TypeError("Class extends value " + String(r2) + " is not a constructor or null");
            function n2() {
              this.constructor = e2;
            }
            t2(e2, r2), e2.prototype = r2 === null ? Object.create(r2) : (n2.prototype = r2.prototype, new n2());
          };
        }(), o = this && this.__assign || function() {
          return (o = Object.assign || function(t2) {
            for (var e2, r2 = 1, n2 = arguments.length; r2 < n2; r2++)
              for (var o2 in e2 = arguments[r2])
                Object.prototype.hasOwnProperty.call(e2, o2) && (t2[o2] = e2[o2]);
            return t2;
          }).apply(this, arguments);
        };
        Object.defineProperty(e, "__esModule", { value: true });
        var i = r(0), a = r(5), c = r(1), u = r(2).default.get().aliasTags, s = function(t2) {
          function e2(e3, r2, n2) {
            return r2 === void 0 && (r2 = "ul"), t2.call(this, e3, r2, n2) || this;
          }
          return n(e2, t2), e2.prototype.__isValidSubTag__ = function(t3) {
            if (!t3)
              return false;
            var e3 = (0, c.getTagConstructor)(t3);
            return t3 === "li" || (u === null || u === void 0 ? void 0 : u[t3]) == "li" || e3 === a.default;
          }, e2.prototype.getValidSubTagName = function(t3) {
            return t3 && this.__isValidSubTag__(t3) ? t3 : null;
          }, e2.prototype.parseValidSubTag = function(t3, e3, r2) {
            var n2 = (0, c.getTagConstructor)(e3);
            return this.__isValidSubTag__(e3) ? new n2(t3, e3, o(o({}, r2), { calcLeading: true, leadingSpace: this.leadingSpace, layer: this.layer, match: "*" })).exec("", "\n") : (console.error("Should not have tags except <li> inside ul, current tag is " + e3 + ", current tagStr is" + t3), "");
          }, e2.prototype.parseOnlyString = function() {
            return "";
          }, e2.prototype.exec = function(e3, r2) {
            return e3 === void 0 && (e3 = "\n"), r2 === void 0 && (r2 = "\n"), t2.prototype.exec.call(this, e3, r2);
          }, e2;
        }(i.default);
        e.default = s;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(1), o = r(2), i = r(9);
        e.default = function(t2, e2, r2) {
          r2 === void 0 && (r2 = false), o.default.reset(), o.default.set(e2, r2), t2 = (t2 = (t2 = (0, n.clearComment)(t2)).trim()).replace(/(\r\n)/g, "").replace(/&nbsp;/g, " ");
          for (var a = (0, n.generateGetNextValidTag)(t2), c = "", u = null, s = a(), l = s[0], p = s[1]; p !== ""; ) {
            if (l != null) {
              var f = new ((0, n.getTagConstructor)(l))(p, l, { parentTag: null, prevTagName: u, prevTagStr: c }).exec(), h = (0, n.isIndependentTag)(u);
              !(0, n.isIndependentTag)(l) || h || c.endsWith("\n") ? c += f : c += "\n" + f;
            } else
              c = (c += new i.default(p, l).exec()).replace(/(?:\n\s*)$/, "\n");
            u = l;
            var d = a();
            l = d[0], p = d[1];
          }
          return function(t3) {
            return t3 = (t3 = (t3 = t3.replace(/^\s+/, "")).replace(/\s+$/, "")).replace(/\u2608/g, " ");
          }((0, n.unescapeStr)(c));
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.unescapeStr = e.extraEscape = void 0;
        var n = {}, o = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;", "`": "&#x60;", "\u201C": "&ldquo;", "\u201D": "&rdquo;" };
        for (var i in o)
          n[o[i]] = i;
        var a = /&(?:amp|lt|gt|quot|#39|#x60|ldquo|rdquo);/g, c = RegExp(a.source), u = [[/\\/g, "\\\\"], [/\*/g, "\\*"], [/^-/g, "\\-"], [/^\+ /g, "\\+ "], [/^(=+)/g, "\\$1"], [/^(#{1,6}) /g, "\\$1 "], [/`/g, "\\`"], [/^~~~/g, "\\~~~"], [/\[/g, "\\["], [/\]/g, "\\]"], [/^>/g, "\\>"], [/_/g, "\\_"], [/^(\d+)\. /g, "$1\\. "]];
        e.unescapeStr = function(t2) {
          return t2 = t2 && c.test(t2) ? t2.replace(a, function(t3) {
            return n[t3];
          }) : t2;
        }, e.extraEscape = function(t2) {
          return u.reduce(function(t3, e2) {
            return t3.replace(e2[0], e2[1]);
          }, t2);
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(11);
        function o(t2, e2) {
          for (var r2 = ""; e2 < t2.length && /[a-zA-Z0-9!-]/.test(t2[e2]); )
            r2 += t2[e2++];
          return r2.toLowerCase();
        }
        e.default = function(t2) {
          var e2 = 0;
          return function() {
            var r2 = "", i = null, a = 0, c = null, u = false;
            if (e2 >= t2.length)
              return [i, r2];
            for (var s = e2; s < t2.length; s++) {
              if (t2[s] === "<" && t2[s + 1] !== "/") {
                if (r2 !== "" && i == null && !u)
                  return e2 = s, [i, r2];
                var l = o(t2, s + 1);
                i == null && (i = l), i === l && a++, (0, n.default)(i) && (--a === 0 && (u = true), a < 0 && console.warn("Tag ".concat(i, " is abnormal")));
              } else if (t2[s] === "<" && t2[s + 1] === "/") {
                if (i == null) {
                  console.warn("Tag is not integrity, current tagStr is ".concat(t2.slice(e2)));
                  for (var p = s; p < t2.length && t2[p] !== ">"; )
                    p++;
                  s = p;
                  continue;
                }
                i === (c = o(t2, s + 2)) && a--, a <= 0 && (u = true);
              }
              if (r2 += t2[s], t2[s] === ">" && u)
                return e2 = s + 1, [i, r2];
              s === t2.length - 1 && i !== c && (c != null && i != null && (r2 = r2.replace("<".concat(i, ">"), "").replace("</".concat(c, ">"), "")), i = null);
            }
            return e2 = t2.length, [i, r2];
          };
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = r(2), o = r(11), i = r(49);
        e.default = function t2(e2) {
          var a, c = n.default.get(), u = c.skipTags, s = c.emptyTags, l = c.ignoreTags, p = c.aliasTags, f = c.renderCustomTags, h = (0, o.default)(e2);
          if (u === null || u === void 0 ? void 0 : u.includes(e2)) {
            var d = r(8);
            return h ? d.__SkipSelfClose__ : d.__Skip__;
          }
          if (s === null || s === void 0 ? void 0 : s.includes(e2)) {
            var _ = r(7);
            return h ? _.__EmptySelfClose__ : _.__Empty__;
          }
          if (l === null || l === void 0 ? void 0 : l.includes(e2))
            return r(5).default;
          if ((p === null || p === void 0 ? void 0 : p[e2]) != null)
            return t2(p[e2]);
          var y = e2.toLowerCase();
          if (f !== true && !(0, i.default)(y)) {
            if (f === false || f === "SKIP")
              return d = r(8), h ? d.__SkipSelfClose__ : d.__Skip__;
            if (f === "EMPTY")
              return _ = r(7), h ? _.__EmptySelfClose__ : _.__Empty__;
            if (f === "IGNORE")
              return r(5).default;
          }
          try {
            a = r(50)("./".concat(e2)).default;
          } catch (v) {
            a = h ? r(10).__NoMatchSelfClose__ : r(10).__NoMatch__;
          }
          return a;
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = ["!doctype", "a", "abbr", "acronym", "address", "applet", "area", "article", "aside", "audio", "b", "base", "basefont", "bdi", "bdo", "bgsound", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "circle", "cite", "clipPath", "code", "col", "colgroup", "command", "content", "data", "datalist", "dd", "defs", "del", "details", "dfn", "dialog", "dir", "div", "dl", "dt", "element", "ellipse", "em", "embed", "fieldset", "figcaption", "figure", "font", "footer", "foreignObject", "form", "frame", "frameset", "g", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "iframe", "image", "img", "input", "ins", "isindex", "kbd", "keygen", "label", "legend", "li", "line", "linearGradient", "link", "listing", "main", "map", "mark", "marquee", "mask", "math", "menu", "menuitem", "meta", "meter", "multicol", "nav", "nextid", "nobr", "noembed", "noframes", "noscript", "object", "ol", "optgroup", "option", "output", "p", "param", "path", "pattern", "picture", "plaintext", "polygon", "polyline", "pre", "progress", "q", "radialGradient", "rb", "rbc", "rect", "rp", "rt", "rtc", "ruby", "s", "samp", "script", "section", "select", "shadow", "slot", "small", "source", "spacer", "span", "stop", "strike", "strong", "style", "sub", "summary", "sup", "svg", "table", "tbody", "td", "template", "text", "textarea", "tfoot", "th", "thead", "time", "title", "tr", "track", "tspan", "tt", "u", "ul", "var", "video", "wbr", "xmp"];
        e.default = function(t2) {
          return typeof t2 === "string" && n.includes(t2.toLowerCase());
        };
      }, function(t, e, r) {
        var n = { "./__Heading__": 3, "./__Heading__.ts": 3, "./__empty__": 7, "./__empty__.ts": 7, "./__ignore__": 5, "./__ignore__.ts": 5, "./__nomatch__": 10, "./__nomatch__.ts": 10, "./__rawString__": 9, "./__rawString__.ts": 9, "./__skip__": 8, "./__skip__.ts": 8, "./a": 18, "./a.ts": 18, "./b": 19, "./b.ts": 19, "./blockquote": 20, "./blockquote.ts": 20, "./br": 21, "./br.ts": 21, "./code": 22, "./code.ts": 22, "./del": 14, "./del.ts": 14, "./em": 15, "./em.ts": 15, "./h1": 23, "./h1.ts": 23, "./h2": 24, "./h2.ts": 24, "./h3": 25, "./h3.ts": 25, "./h4": 26, "./h4.ts": 26, "./h5": 27, "./h5.ts": 27, "./h6": 28, "./h6.ts": 28, "./hr": 29, "./hr.ts": 29, "./i": 30, "./i.ts": 30, "./img": 31, "./img.ts": 31, "./input": 32, "./input.ts": 32, "./li": 33, "./li.ts": 33, "./ol": 34, "./ol.ts": 34, "./p": 35, "./p.ts": 35, "./pre": 36, "./pre.ts": 36, "./s": 37, "./s.ts": 37, "./span": 38, "./span.ts": 38, "./strong": 13, "./strong.ts": 13, "./table": 39, "./table.ts": 39, "./tbody": 40, "./tbody.ts": 40, "./td": 41, "./td.ts": 41, "./th": 16, "./th.ts": 16, "./thead": 42, "./thead.ts": 42, "./tr": 43, "./tr.ts": 43, "./ul": 44, "./ul.ts": 44 };
        function o(t2) {
          var e2 = i(t2);
          return r(e2);
        }
        function i(t2) {
          if (!r.o(n, t2)) {
            var e2 = new Error("Cannot find module '" + t2 + "'");
            throw e2.code = "MODULE_NOT_FOUND", e2;
          }
          return n[t2];
        }
        o.keys = function() {
          return Object.keys(n);
        }, o.resolve = i, t.exports = o, o.id = 50;
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.default = function(t2) {
          for (var e2 = {}, r2 = false, n = "", o = "", i = null, a = 0; a <= t2.length; a++) {
            if (a === t2.length || /\s/.test(t2[a])) {
              if (a === t2.length || !r2) {
                var c = n.trim();
                c[c.length - 1] === "/" && (c = c.slice(0, c.length - 1)), c && (e2[c] = o.trim()), n = "", o = "";
              }
            } else {
              if (/['"]/.test(t2[a]) && (!i || t2[a] === i)) {
                (r2 = !r2) && (i = t2[a]);
                continue;
              }
              if (t2[a] === "=" && !r2)
                continue;
            }
            if (a === t2.length)
              break;
            r2 ? o += t2[a] : n += t2[a];
          }
          return e2;
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true });
        var n = "javascript";
        e.default = function(t2) {
          var e2 = t2.match(/<.*?class=".*?language-([^\s"]*)?.*".*>/);
          return e2 ? e2[1] || "" : t2.match(/<span.*?hljs-(comment|keyword|number|string|literal|built_in|function|title|bullet).*?<\/span>/) ? n : "";
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.default = function(t2) {
          return t2.replace(/<!--(?:[\s\S]*?)-->/g, "");
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.default = function(t2, e2) {
          var r2 = { _default_: "---|", center: ":---:|", left: ":---|", right: "---:|", start: ":---|", end: "---:|" }, n = Array(e2).fill(r2._default_), o = t2.match(/<(td|th)(.*?)>/g);
          return o ? n = (n = o.slice(0, e2)).map(function(t3) {
            var e3 = t3.match(/align\s*=\s*['"]\s*(center|left|right|start|end)/), n2 = t3.match(/text-align\s*:\s*(center|left|right|start|end)/);
            return e3 || n2 ? e3 && !n2 ? r2[e3[1]] || r2._default_ : n2 ? r2[n2[1]] || r2._default_ : void 0 : r2._default_;
          }) : n;
        };
      }, function(t, e, r) {
        "use strict";
        Object.defineProperty(e, "__esModule", { value: true }), e.default = ["th", "td"];
      }]).default;
    });
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AnyBlockPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");
var import_obsidian6 = require("obsidian");

// src/ABConverter/converter/ABConvert.ts
var ABConvert = class {
  constructor(process) {
    this.is_disable = false;
    this.register_from = "\u5185\u7F6E";
    this.is_enable = false;
    if ("process" in process) {
      this.constructor_simp(process);
    } else {
      this.constructor_user(process);
    }
  }
  static factory(process) {
    let ret = new ABConvert(process);
    ABConvertManager.getInstance().list_abConvert.push(ret);
    return ret;
  }
  constructor_simp(sim) {
    var _a, _b, _c, _d, _e, _f;
    this.id = sim.id;
    this.name = sim.name;
    this.match = (_a = sim.match) != null ? _a : sim.id;
    this.default = ((_b = sim.default) != null ? _b : !sim.match || typeof sim.match == "string") ? sim.id : null;
    this.detail = (_c = sim.detail) != null ? _c : "";
    this.process_alias = (_d = sim.process_alias) != null ? _d : "";
    this.process_param = (_e = sim.process_param) != null ? _e : null;
    this.process_return = (_f = sim.process_return) != null ? _f : null;
    this.process = sim.process;
    this.is_disable = false;
    this.register_from = "\u5185\u7F6E";
  }
  constructor_user(sim) {
    this.id = sim.id;
    this.name = sim.name;
    this.match = /^\//.test(sim.match) ? RegExp(sim.match) : sim.match;
    this.default = null;
    this.detail = "";
    this.process_alias = sim.process_alias;
    this.process_param = null;
    this.process_return = null;
    this.process = () => {
    };
    this.is_disable = false;
    this.register_from = "\u7528\u6237";
  }
  destructor() {
    const index = ABConvertManager.getInstance().list_abConvert.indexOf(this);
    if (index > -1) {
      ABConvertManager.getInstance().list_abConvert.splice(index, 1);
    }
  }
};

// src/ABConverter/ABReg.ts
var ABReg = {
  reg_header: /^((\s|>\s|-\s|\*\s|\+\s)*)(%%)?(\[((?!toc)(?!TOC)[0-9a-zA-Z\u4e00-\u9fa5].*)\]):?(%%)?\s*$/,
  reg_mdit_head: /^((\s|>\s|-\s|\*\s|\+\s)*)(:::)\s?(.*)/,
  reg_mdit_tail: /^((\s|>\s|-\s|\*\s|\+\s)*)(:::)/,
  reg_list: /^((\s|>\s|-\s|\*\s|\+\s)*)(-\s|\*\s|\+\s)(.*)/,
  reg_code: /^((\s|>\s|-\s|\*\s|\+\s)*)(```|~~~)(.*)/,
  reg_quote: /^((\s|>\s|-\s|\*\s|\+\s)*)(>\s)(.*)/,
  reg_heading: /^((\s|>\s|-\s|\*\s|\+\s)*)(\#+\s)(.*)/,
  reg_table: /^((\s|>\s|-\s|\*\s|\+\s)*)(\|(.*)\|)/,
  reg_header_noprefix: /^((\s)*)(%%)?(\[((?!toc)(?!TOC)[0-9a-zA-Z\u4e00-\u9fa5].*)\]):?(%%)?\s*$/,
  reg_mdit_head_noprefix: /^((\s)*)(:::)\s?(.*)/,
  reg_mdit_tail_noprefix: /^((\s)*)(:::)/,
  reg_list_noprefix: /^((\s)*)(-\s|\*\s|\+\s)(.*)/,
  reg_code_noprefix: /^((\s)*)(```|~~~)(.*)/,
  reg_quote_noprefix: /^((\s)*)(>\s)(.*)/,
  reg_heading_noprefix: /^((\s)*)(\#+\s)(.*)/,
  reg_table_noprefix: /^((\s)*)(\|(.*)\|)/,
  reg_emptyline_noprefix: /^\s*$/,
  reg_indentline_noprefix: /^\s+?\S/,
  inline_split: /\| |,  | |\.  |:  | /
};

// src/ABConverter/ABConvertManager.ts
var ABConvertManager = class {
  constructor() {
    this.list_abConvert = [];
    this.m_renderMarkdownFn = (markdown, el) => {
      console.error("AnyBlockError: \u8BF7\u5148\u5236\u5B9A/\u91CD\u5B9A\u4E49md\u6E32\u67D3\u5668");
    };
    if (typeof obsidian == "undefined" && typeof app == "undefined") {
      console.log("[environment]: markdown-it, without obsidian");
    } else {
      console.log("[environment]: obsidian");
    }
  }
  static getInstance() {
    if (!ABConvertManager.m_instance) {
      ABConvertManager.m_instance = new ABConvertManager();
    }
    return ABConvertManager.m_instance;
  }
  getConvertOptions() {
    return this.list_abConvert.filter((item) => {
      return item.default;
    }).map((item) => {
      return { id: item.default, name: item.name };
    });
  }
  redefine_renderMarkdown(callback) {
    this.m_renderMarkdownFn = callback;
  }
  static autoABConvert(el, header, content, selectorName = "") {
    let prev_result = content;
    let prev_type = "string" /* text */;
    header = this.autoABConvert_natureLanguage(el, header, content, selectorName);
    let list_header = header.split("|");
    prev_result = this.autoABConvert_runConvert(el, list_header, prev_result, prev_type);
    if (typeof prev_result == "string" && prev_type == "string" /* text */) {
      const subEl = document.createElement("div");
      el.appendChild(subEl);
      ABConvertManager.getInstance().m_renderMarkdownFn(prev_result, subEl);
      prev_type = "HTMLElement" /* el */;
      prev_result = el;
    }
  }
  static autoABConvert_runConvert(el, list_header, prev_result, prev_type) {
    for (let item_header of list_header) {
      for (let abReplaceProcessor of ABConvertManager.getInstance().list_abConvert) {
        if (typeof abReplaceProcessor.match == "string") {
          if (abReplaceProcessor.match != item_header)
            continue;
        } else {
          if (!abReplaceProcessor.match.test(item_header))
            continue;
        }
        if (abReplaceProcessor.process_alias) {
          let alias = abReplaceProcessor.process_alias;
          (() => {
            if (abReplaceProcessor.process_alias.indexOf("%") < 0)
              return;
            if (typeof abReplaceProcessor.match == "string")
              return;
            const matchs = item_header.match(abReplaceProcessor.match);
            if (!matchs)
              return;
            const len = matchs.length;
            if (len == 1)
              return;
            for (let i = 1; i < len; i++) {
              if (!matchs[i])
                continue;
              alias = alias.replace(RegExp(`%${i}`), matchs[i]);
            }
          })();
          prev_result = this.autoABConvert_runConvert(el, alias.split("|"), prev_result, prev_type);
        } else if (abReplaceProcessor.process) {
          if (abReplaceProcessor.process_param != prev_type) {
            if (abReplaceProcessor.process_param == "HTMLElement" /* el */ && typeof prev_result == "string" && prev_type == "string" /* text */) {
              const subEl = document.createElement("div");
              el.appendChild(subEl);
              ABConvertManager.getInstance().m_renderMarkdownFn(prev_result, subEl);
              prev_type = "HTMLElement" /* el */;
              prev_result = el;
            } else {
              console.warn("\u5904\u7406\u5668\u53C2\u6570\u7C7B\u578B\u9519\u8BEF", abReplaceProcessor.id, abReplaceProcessor.process_param, prev_type);
              break;
            }
          }
          prev_result = abReplaceProcessor.process(el, item_header, prev_result);
          if (typeof prev_result == "string") {
            prev_type = "string" /* text */;
          } else if (typeof prev_result == "object") {
            prev_type = "HTMLElement" /* el */;
          } else {
            console.warn("\u5904\u7406\u5668\u8F93\u51FA\u7C7B\u578B\u9519\u8BEF", abReplaceProcessor.id, abReplaceProcessor.process_param, prev_type);
            break;
          }
        } else {
          console.warn("\u5904\u7406\u5668\u5FC5\u987B\u5B9E\u73B0process\u6216process_alias\u65B9\u6CD5");
        }
      }
    }
    return prev_result;
  }
  static autoABConvert_natureLanguage(el, header, content, selectorName) {
    if (!header.trimEnd().endsWith("|"))
      header = header + "|";
    if (!header.trimStart().startsWith("|"))
      header = "|" + header;
    if (selectorName == "headtail") {
      header = "|::: 140lne" + header.trimStart();
      header = header.replace(/^\|::: 140lne\|info\|/, "|add([!info])|quote|");
      header = header.replace(/^\|::: 140lne\|note\|/, "|add([!note])|quote|");
      header = header.replace(/^\|::: 140lne\|warn\|/, "|add([!warning])|quote|");
      header = header.replace(/^\|::: 140lne\|warning\|/, "|add([!warning])|quote|");
      header = header.replace(/^\|::: 140lne\|error\|/, "|add([!error])|quote|");
      header = header.replace(/^\|::: 140lne\|tab\|/, "|mditTabs|");
      header = header.replace(/^\|::: 140lne\|tabs\|/, "|mditTabs|");
      header = header.replace(/^\|::: 140lne\|\|/, "|mditTabs|");
      header = header.replace(/^\|::: 140lne\|\|/, "|mditTabs|");
      header = header.replace(/^\|::: 140lne\|demo\|/, "|mditDemo|");
      header = header.replace(/^\|::: 140lne\|abDemo\|/, "|mditABDemo|");
      header = header.replace(/^\|::: 140lne\|col\|/, "|mditCol|");
      header = header.replace(/^\|::: 140lne\|\|/, "|mditCol|");
      header = header.replace(/^\|::: 140lne\|card\|/, "|mditCard|");
      header = header.replace(/^\|::: 140lne\|\|/, "|mditCard|");
      header = header.replace(/^\|::: 140lne/, "");
    } else if (selectorName == "list" || ABReg.reg_list_noprefix.test(content.trimStart()) || selectorName == "title" || ABReg.reg_heading_noprefix.test(content.trimStart())) {
      if (selectorName == "title" || ABReg.reg_heading_noprefix.test(content.trimStart())) {
        header = "|title 140lne" + header;
        header = header.replace(/^\|title 140lne\|tab\|/, "|title2tab|");
        header = header.replace(/^\|title 140lne\|tabs\|/, "|title2tab|");
        header = header.replace(/^\|title 140lne\|\|/, "|title2tab|");
        header = header.replace(/^\|title 140lne\|\|/, "|title2tab|");
        header = header.replace(/^\|title 140lne\|col\|/, "|title2col|");
        header = header.replace(/^\|title 140lne\|\|/, "|title2col|");
        header = header.replace(/^\|title 140lne\|card\|/, "|title2card|");
        header = header.replace(/^\|title 140lne\|\|/, "|title2card|");
        header = header.replace(/^\|title 140lne/, "");
      }
      const old_list_header = header;
      header = "|list 140lne" + header;
      header = header.replace(/^\|list 140lne\|flow\|/, "|list2mermaid|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2mermaid|");
      header = header.replace(/^\|list 140lne\|mindmap\|/, "|list2pumlMindmap|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2pumlMindmap|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2pumlMindmap|");
      header = header.replace(/^\|list 140lne\|mdMindmap\|/, "|list2markmap|");
      header = header.replace(/^\|list 140lne\|md\|/, "|list2markmap|");
      header = header.replace(/^\|list 140lne\|md\|/, "|list2markmap|");
      header = header.replace(/^\|list 140lne\|wbs\|/, "|list2pumlWBS|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2pumlWBS|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2pumlWBS|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2pumlWBS|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2pumlWBS|");
      header = header.replace(/^\|list 140lne\|table\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|multiWayTable\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|multiCrossTable\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|crossTable\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2table|");
      header = header.replace(/^\|list 140lne\|listTable\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|treeTable\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|listGrid\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|treeGrid\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2lt|");
      header = header.replace(/^\|list 140lne\|list\|/, "|list2lt|addClass(ab-listtable-likelist)|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2lt|addClass(ab-listtable-likelist)|");
      header = header.replace(/^\|list 140lne\|dirTree\|/, "|list2dt|");
      header = header.replace(/^\|list 140lne\|dir\|/, "|list2dt|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2dt|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2dt|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2dt|");
      header = header.replace(/^\|list 140lne\|timeline\|/, "|list2timeline|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2timeline|");
      header = header.replace(/^\|list 140lne\|fakeList\|/, "|list2table|addClass(ab-table-fc)|addClass(ab-table-likelist)|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2table|addClass(ab-table-fc)|addClass(ab-table-likelist)|");
      header = header.replace(/^\|list 140lne\|tab\|/, "|list2tab|");
      header = header.replace(/^\|list 140lne\|tabs\|/, "|list2tab|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2tab|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2tab|");
      header = header.replace(/^\|list 140lne\|col\|/, "|list2col|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2col|");
      header = header.replace(/^\|list 140lne\|card\|/, "|list2card|");
      header = header.replace(/^\|list 140lne\|\|/, "|list2card|");
      header = header.replace(/^\|list 140lne/, "");
      if (old_list_header != header) {
        if (selectorName == "title" || ABReg.reg_heading_noprefix.test(content.trimStart())) {
          header = "|title2list" + header;
        }
      }
    } else if (selectorName == "code" || ABReg.reg_code_noprefix.test(content.trimStart())) {
      header = "|code 140lne" + header;
      header = header.replace(/\|code 140lne\|X\|/, "|Xcode|");
      header = header.replace(/\|code 140lne/, "");
    } else if (selectorName == "quote" || ABReg.reg_quote_noprefix.test(content.trimStart())) {
      header = "|quote 140lne" + header;
      header = header.replace(/quote 140lne|X\|/, "|Xquote|");
      header = header.replace(/qutoe 140lne/, "");
    }
    {
      header = "|general 140lne" + header;
      header = header.replace(/\|\|/, "|add_class(ab-deco-heimu)|");
      header = header.replace(/\|\|/, "|fold|");
      header = header.replace(/\|\|/, "|scroll|");
      header = header.replace(/\|\|/, "|overfold|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-red)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-orange)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-yellow)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-green)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-cyan)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-blue)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-purple)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-white)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-text-black)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-red)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-orange)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-yellow)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-green)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-cyan)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-blue)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-purple)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-white)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-bg-black)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-top)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-down)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-left)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-right)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-center)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-hcenter)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-vcenter)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-dire-justify)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-large)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-largex)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-largexx)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-small)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-smallx)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-smallxx)|");
      header = header.replace(/\|\|/, "|addClass(ab-custom-font-bold)|");
      header = header.replace(/\|general 140lne/, "");
    }
    return header;
  }
};

// src/ABConverter/converter/abc_text.ts
var abc_quote = ABConvert.factory({
  id: "quote",
  name: "\u589E\u52A0\u5F15\u7528\u5757",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    return content.split("\n").map((line) => {
      return "> " + line;
    }).join("\n");
  }
});
var abc_code = ABConvert.factory({
  id: "code",
  name: "\u589E\u52A0\u4EE3\u7801\u5757",
  match: /^code(\((.*)\))?$/,
  default: "code()",
  detail: "\u4E0D\u52A0`()`\u8868\u793A\u7528\u539F\u6587\u672C\u7684\u7B2C\u4E00\u884C\u4F5C\u4E3A\u4EE3\u7801\u7C7B\u578B\uFF0C\u62EC\u53F7\u7C7B\u578B\u4E3A\u7A7A\u8868\u793A\u4EE3\u7801\u7C7B\u578B\u4E3A\u7A7A",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    let matchs = header.match(/^code(\((.*)\))?$/);
    if (!matchs)
      return content;
    if (matchs[1])
      content = matchs[2] + "\n" + content;
    return "```" + content + "\n```";
  }
});
var abc_Xquote = ABConvert.factory({
  id: "Xquote",
  name: "\u53BB\u9664\u5F15\u7528\u5757",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    return content.split("\n").map((line) => {
      return line.replace(/^>\s/, "");
    }).join("\n");
  }
});
var abc_Xcode = ABConvert.factory({
  id: "Xcode",
  name: "\u53BB\u9664\u4EE3\u7801\u5757",
  match: /^Xcode(\((true|false)\))?$/,
  default: "Xcode(true)",
  detail: "\u53C2\u6570\u4E3A\u662F\u5426\u79FB\u9664\u4EE3\u7801\u7C7B\u578B, \u9ED8\u8BA4\u4E3Afalse\u3002\u8BB0\u6CD5: code|Xcode\u6216code()|Xcode(true)\u5185\u5BB9\u4E0D\u53D8",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    let matchs = header.match(/^Xcode(\((true|false)\))?$/);
    if (!matchs)
      return content;
    let remove_flag;
    if (matchs[1] == "")
      remove_flag = false;
    else
      remove_flag = matchs[2] == "true";
    let list_content = content.split("\n");
    let code_flag = "";
    let line_start = -1;
    let line_end = -1;
    for (let i = 0; i < list_content.length; i++) {
      if (code_flag == "") {
        const match_tmp = list_content[i].match(ABReg.reg_code);
        if (match_tmp) {
          code_flag = match_tmp[3];
          line_start = i;
        }
      } else {
        if (list_content[i].indexOf(code_flag) >= 0) {
          line_end = i;
          break;
        }
      }
    }
    if (line_start >= 0 && line_end > 0) {
      if (remove_flag)
        list_content[line_start] = list_content[line_start].replace(/^```(.*)$|^~~~(.*)$/, "");
      else
        list_content[line_start] = list_content[line_start].replace(/^```|^~~~/, "");
      list_content[line_end] = list_content[line_end].replace(/^```|^~~~/, "");
      content = list_content.join("\n");
    }
    return content;
  }
});
var abc_X = ABConvert.factory({
  id: "X",
  name: "\u53BB\u9664\u4EE3\u7801\u6216\u5F15\u7528\u5757",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    let flag = "";
    for (let line of content.split("\n")) {
      if (ABReg.reg_code.test(line)) {
        flag = "code";
        break;
      } else if (ABReg.reg_quote.test(line)) {
        flag = "quote";
        break;
      }
    }
    if (flag == "code")
      return abc_Xcode.process(el, header, content);
    else if (flag == "quote")
      return abc_Xquote.process(el, header, content);
    return content;
  }
});
var abc_code2quote = ABConvert.factory({
  id: "code2quote",
  name: "\u4EE3\u7801\u8F6C\u5F15\u7528\u5757",
  process_alias: "Xcode|quote",
  process: () => {
  }
});
var abc_quote2code = ABConvert.factory({
  id: "quote2code",
  name: "\u5F15\u7528\u8F6C\u4EE3\u7801\u5757",
  match: /^quote2code(\((.*)\))?$/,
  default: "quote2code()",
  process_alias: "Xquote|code%1",
  process: () => {
  }
});
var abc_slice = ABConvert.factory({
  id: "slice",
  name: "\u5207\u7247",
  match: /^slice\((\s*\d+\s*?)(,\s*-?\d+\s*)?\)$/,
  detail: "\u548Cjs\u7684slice\u65B9\u6CD5\u662F\u4E00\u6837\u7684",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    const list_match = header.match(/^slice\((\s*\d+\s*)(,\s*-?\d+\s*)?\)$/);
    if (!list_match)
      return content;
    const arg1 = Number(list_match[1].trim());
    if (isNaN(arg1))
      return content;
    const arg2 = Number(list_match[2].replace(",", "").trim());
    if (isNaN(arg2)) {
      return content.split("\n").slice(arg1).join("\n");
    } else {
      return content.split("\n").slice(arg1, arg2).join("\n");
    }
  }
});
var abc_add = ABConvert.factory({
  id: "add",
  name: "\u589E\u6DFB\u5185\u5BB9",
  match: /^add\((.*?)(,\s*-?\d+\s*)?\)$/,
  detail: "\u589E\u6DFB. \u53C2\u65702\u4E3A\u884C\u5E8F, \u9ED8\u8BA40, \u884C\u5C3E-1\u3002\u4F1A\u63D2\u884C\u589E\u6DFB",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    const list_match = header.match(/^add\((.*?)(,\s*-?\d+\s*)?\)$/);
    if (!list_match)
      return content;
    if (!list_match[1])
      return content;
    const arg1 = list_match[1].trim();
    if (!arg1)
      return content;
    let arg2;
    if (!list_match[2])
      arg2 = 0;
    else {
      arg2 = Number(list_match[2].replace(",", "").trim());
      if (isNaN(arg2)) {
        arg2 = 0;
      }
    }
    const list_content = content.split("\n");
    if (arg2 >= 0 && arg2 < list_content.length)
      list_content[arg2] = arg1 + "\n" + list_content[arg2];
    else if (arg2 < 0 && arg2 * -1 <= list_content.length) {
      arg2 = list_content.length + arg2;
      list_content[arg2] = arg1 + "\n" + list_content[arg2];
    }
    return list_content.join("\n");
  }
});
var abc_listroot = ABConvert.factory({
  id: "listroot",
  name: "\u589E\u52A0\u5217\u8868\u6839",
  match: /^listroot\((.*)\)$/,
  default: "listroot(root)",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    const list_match = header.match(/^listroot\((.*)\)$/);
    if (!list_match)
      return content;
    const arg1 = list_match[1].trim();
    content = content.split("\n").map((line) => {
      return "  " + line;
    }).join("\n");
    content = "- " + arg1 + "\n" + content;
    return content;
  }
});
var abc_callout = ABConvert.factory({
  id: "callout",
  name: "callout\u8BED\u6CD5\u7CD6",
  match: /^\!/,
  default: "!note",
  detail: "\u9700\u8981obsidian 0.14\u7248\u672C\u4EE5\u4E0A\u6765\u652F\u6301callout\u8BED\u6CD5",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    return "```ad-" + header.slice(1) + "\n" + content + "\n```";
  }
});

// src/ABConverter/converter/abc_list.ts
var ListProcess = class {
  static title2list(text, div) {
    if (!text.trimStart().startsWith("#"))
      return text;
    let list_itemInfo = this.title2data(text);
    list_itemInfo = this.data2strict(list_itemInfo).map((item, index) => {
      return { content: item.content, level: item.level * 2 };
    });
    return this.data2list(list_itemInfo);
  }
  static listXinline(text) {
    const data = this.list2data(text);
    return this.data2list(data);
  }
  static list2data(text, modeG = true) {
    let list_inline_comp = [];
    function update_inline_comp(level, inline_comp) {
      if (list_inline_comp.length == 0 && inline_comp == 0)
        return 0;
      while (list_inline_comp.length && list_inline_comp[list_inline_comp.length - 1].level >= level) {
        list_inline_comp.pop();
      }
      if (list_inline_comp.length == 0 && inline_comp == 0)
        return 0;
      let total_comp;
      if (list_inline_comp.length == 0)
        total_comp = 0;
      else
        total_comp = list_inline_comp[list_inline_comp.length - 1].inline_comp;
      if (inline_comp > 0)
        list_inline_comp.push({
          level,
          inline_comp: inline_comp + total_comp
        });
      return total_comp;
    }
    let list_itemInfo = [];
    const list_text = text.split("\n");
    for (let line of list_text) {
      const m_line = line.match(ABReg.reg_list_noprefix);
      if (m_line) {
        let list_inline = m_line[4].split(ABReg.inline_split);
        let level_inline = m_line[1].length;
        let inline_comp = update_inline_comp(level_inline, list_inline.length - 1);
        for (let index = 0; index < list_inline.length; index++) {
          list_itemInfo.push({
            content: list_inline[index],
            level: level_inline + index + inline_comp
          });
        }
      } else {
        let itemInfo = list_itemInfo.pop();
        if (itemInfo) {
          list_itemInfo.push({
            content: itemInfo.content + "\n" + line.trim(),
            level: itemInfo.level
          });
        }
      }
    }
    return list_itemInfo;
  }
  static title2data(text) {
    let list_itemInfo = [];
    const list_text = text.split("\n");
    let mul_mode = "";
    for (let line of list_text) {
      const match_heading = line.match(ABReg.reg_heading_noprefix);
      const match_list = line.match(ABReg.reg_list_noprefix);
      if (match_heading && !match_heading[1]) {
        removeTailBlank();
        list_itemInfo.push({
          content: match_heading[4],
          level: match_heading[3].length - 1 - 10
        });
        mul_mode = "title";
      } else if (match_list) {
        removeTailBlank();
        list_itemInfo.push({
          content: match_list[4],
          level: match_list[1].length + 1
        });
        mul_mode = "list";
      } else if (/^\S/.test(line) && mul_mode == "list") {
        list_itemInfo[list_itemInfo.length - 1].content = list_itemInfo[list_itemInfo.length - 1].content + "\n" + line;
      } else {
        if (mul_mode == "para") {
          list_itemInfo[list_itemInfo.length - 1].content = list_itemInfo[list_itemInfo.length - 1].content + "\n" + line;
        } else if (/^\s*$/.test(line)) {
          continue;
        } else {
          list_itemInfo.push({
            content: line,
            level: 0
          });
          mul_mode = "para";
        }
      }
    }
    removeTailBlank();
    return list_itemInfo;
    function removeTailBlank() {
      if (mul_mode == "para" || mul_mode == "list") {
        list_itemInfo[list_itemInfo.length - 1].content = list_itemInfo[list_itemInfo.length - 1].content.replace(/\s*$/, "");
      }
    }
  }
  static old_ulist2data(text) {
    let list_itemInfo = [];
    let level1 = -1;
    let level2 = -1;
    const list_text = text.split("\n");
    for (let line of list_text) {
      const m_line = line.match(ABReg.reg_list_noprefix);
      if (m_line) {
        let level_inline = m_line[1].length;
        let this_level;
        if (level1 < 0) {
          level1 = level_inline;
          this_level = 1;
        } else if (level1 >= level_inline)
          this_level = 1;
        else if (level2 < 0) {
          level2 = level_inline;
          this_level = 2;
        } else if (level2 >= level_inline)
          this_level = 2;
        else {
          let itemInfo = list_itemInfo.pop();
          if (itemInfo) {
            list_itemInfo.push({
              content: itemInfo.content + "\n" + line.trim(),
              level: itemInfo.level
            });
          }
          continue;
        }
        list_itemInfo.push({
          content: m_line[4],
          level: this_level
        });
      } else {
        let itemInfo = list_itemInfo.pop();
        if (itemInfo) {
          list_itemInfo.push({
            content: itemInfo.content + "\n" + line.trim(),
            level: itemInfo.level
          });
        }
      }
    }
    let count_level_2 = 0;
    for (let item of list_itemInfo) {
      if (item.level == 2) {
        item.level += count_level_2;
        count_level_2++;
      } else {
        count_level_2 = 0;
      }
    }
    return list_itemInfo;
  }
  static data2strict(list_itemInfo) {
    let list_prev_level = [-999];
    let list_itemInfo2 = [];
    for (let itemInfo of list_itemInfo) {
      let new_level = 0;
      for (let i = 0; i < list_prev_level.length; i++) {
        if (list_prev_level[i] < itemInfo.level)
          continue;
        else if (list_prev_level[i] == itemInfo.level) {
          list_prev_level = list_prev_level.slice(0, i + 1);
          new_level = i;
          break;
        } else {
          list_prev_level = list_prev_level.slice(0, i);
          list_prev_level.push(itemInfo.level);
          new_level = i;
          break;
        }
      }
      if (new_level == 0) {
        list_prev_level.push(itemInfo.level);
        new_level = list_prev_level.length - 1;
      }
      list_itemInfo2.push({
        content: itemInfo.content,
        level: new_level - 1
      });
    }
    return list_itemInfo2;
  }
  static data_2L_2_mL1B(list_itemInfo) {
    let list_itemInfo2 = [];
    let count_level_2 = 0;
    for (let item of list_itemInfo) {
      if (item.level != 0) {
        list_itemInfo2.push({
          content: item.content,
          level: item.level + count_level_2
        });
        count_level_2++;
      } else {
        list_itemInfo2.push({
          content: item.content,
          level: item.level
        });
        count_level_2 = 0;
      }
    }
    return list_itemInfo2;
  }
  static data2list(list_itemInfo) {
    let list_newcontent = [];
    for (let item of list_itemInfo) {
      const str_indent = " ".repeat(item.level);
      let list_content = item.content.split("\n");
      for (let i = 0; i < list_content.length; i++) {
        if (i == 0)
          list_newcontent.push(str_indent + "- " + list_content[i]);
        else
          list_newcontent.push(str_indent + "  " + list_content[i]);
      }
    }
    const newcontent = list_newcontent.join("\n");
    return newcontent;
  }
};
var abc_title2list = ABConvert.factory({
  id: "title2list",
  name: "\u6807\u9898\u5230\u5217\u8868",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  detail: "\u4E5F\u53EF\u4EE5\u5F53\u4F5C\u662F\u66F4\u5F3A\u5927\u7684\u5217\u8868\u89E3\u6790\u5668",
  process: (el, header, content) => {
    content = ListProcess.title2list(content, el);
    return content;
  }
});
var abc_listXinline = ABConvert.factory({
  id: "listXinline",
  name: "\u5217\u8868\u6D88\u9664\u5185\u8054\u6362\u884C",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    return ListProcess.listXinline(content);
  }
});

// src/ABConverter/converter/abc_c2list.ts
var C2ListProcess = class {
  static data_mL_2_2L1B(list_itemInfo) {
    let list_itemInfo2 = [];
    const level1 = 0;
    const level2 = 1;
    let flag_leve2 = false;
    for (let itemInfo of list_itemInfo) {
      if (level1 >= itemInfo.level) {
        list_itemInfo2.push({
          content: itemInfo.content.trim(),
          level: level1
        });
        flag_leve2 = false;
        continue;
      }
      if (true) {
        if (!flag_leve2) {
          list_itemInfo2.push({
            content: itemInfo.content.trim(),
            level: level2
          });
          flag_leve2 = true;
          continue;
        } else {
          let old_itemInfo = list_itemInfo2.pop();
          if (old_itemInfo) {
            let new_content = itemInfo.content.trim();
            if (itemInfo.level > level2)
              new_content = "- " + new_content;
            for (let i = 0; i < itemInfo.level - level2; i++)
              new_content = " " + new_content;
            new_content = old_itemInfo.content + "\n" + new_content;
            list_itemInfo2.push({
              content: new_content,
              level: level2
            });
          }
        }
      }
    }
    return list_itemInfo2;
  }
  static data_mL_2_2L(list_itemInfo) {
    let list_itemInfo2 = [];
    const level1 = 0;
    const level2 = 1;
    for (let itemInfo of list_itemInfo) {
      if (level1 >= itemInfo.level) {
        list_itemInfo2.push({
          content: itemInfo.content.trim(),
          level: level1
        });
        continue;
      }
      if (level2 >= itemInfo.level) {
        list_itemInfo2.push({
          content: itemInfo.content.trim(),
          level: level2
        });
        continue;
      } else {
        let old_itemInfo = list_itemInfo2.pop();
        if (old_itemInfo) {
          let new_content = itemInfo.content.trim();
          if (itemInfo.level > level2)
            new_content = "- " + new_content;
          for (let i = 0; i < itemInfo.level - level2; i++)
            new_content = " " + new_content;
          new_content = old_itemInfo.content + "\n" + new_content;
          list_itemInfo2.push({
            content: new_content,
            level: level2
          });
        }
      }
    }
    return list_itemInfo2;
  }
  static list2c2data(text) {
    let list_itemInfo = [];
    const list_text = text.trimStart().split("\n");
    const first_match = list_text[0].match(ABReg.reg_list_noprefix);
    if (!first_match || first_match[1]) {
      console.error("\u4E0D\u662F\u5217\u8868\u5185\u5BB9:", list_text[0]);
      return list_itemInfo;
    }
    const root_list_level = first_match[1].length;
    let current_content = "";
    for (let line of list_text) {
      const match_list = line.match(ABReg.reg_list_noprefix);
      if (match_list && !match_list[1] && match_list[1].length <= root_list_level) {
        add_current_content();
        list_itemInfo.push({
          content: match_list[4],
          level: 0
        });
      } else {
        current_content += line + "\n";
      }
    }
    add_current_content();
    return list_itemInfo;
    function add_current_content() {
      if (current_content.trim() == "")
        return;
      list_itemInfo.push({
        content: current_content,
        level: 1
      });
      current_content = "";
    }
  }
  static title2c2data(text) {
    let list_itemInfo = [];
    const list_text = text.trimStart().split("\n");
    const first_match = list_text[0].match(ABReg.reg_heading_noprefix);
    if (!first_match || first_match[1]) {
      console.error("\u4E0D\u662F\u6807\u9898\u5185\u5BB9:", list_text[0]);
      return list_itemInfo;
    }
    const root_title_level = first_match[3].length - 1;
    let current_content = "";
    for (let line of list_text) {
      const match_heading = line.match(ABReg.reg_heading_noprefix);
      if (match_heading && !match_heading[1] && match_heading[3].length - 1 <= root_title_level) {
        add_current_content();
        list_itemInfo.push({
          content: match_heading[4],
          level: 0
        });
      } else {
        current_content += line + "\n";
      }
    }
    add_current_content();
    return list_itemInfo;
    function add_current_content() {
      if (current_content.trim() == "")
        return;
      list_itemInfo.push({
        content: current_content,
        level: 1
      });
      current_content = "";
    }
  }
  static c2data2tab(list_itemInfo, div, modeT) {
    {
      const tab = document.createElement("div");
      div.appendChild(tab);
      tab.classList.add("ab-tab-root");
      if (modeT)
        tab.setAttribute("modeT", "true");
      const nav = document.createElement("div");
      tab.appendChild(nav);
      nav.classList.add("ab-tab-nav");
      const content = document.createElement("div");
      tab.appendChild(content);
      content.classList.add("ab-tab-content");
      let current_dom = null;
      for (let i = 0; i < list_itemInfo.length; i++) {
        const itemInfo = list_itemInfo[i];
        if (!current_dom) {
          if (itemInfo.level == 0) {
            const nav_item = document.createElement("button");
            nav.appendChild(nav_item);
            nav_item.classList.add("ab-tab-nav-item");
            nav_item.textContent = itemInfo.content.slice(0, 20);
            nav_item.setAttribute("is_activate", i == 0 ? "true" : "false");
            current_dom = document.createElement("div");
            content.appendChild(current_dom);
            current_dom.classList.add("ab-tab-content-item");
            current_dom.setAttribute("style", i == 0 ? "display:block" : "display:none");
            current_dom.setAttribute("is_activate", i == 0 ? "true" : "false");
          }
        } else {
          ABConvertManager.getInstance().m_renderMarkdownFn(itemInfo.content, current_dom);
          current_dom = null;
        }
      }
      const lis = tab.querySelectorAll(".ab-tab-nav-item");
      const contents = tab.querySelectorAll(".ab-tab-content-item");
      if (lis.length != contents.length)
        console.warn("ab-tab-nav-item\u548Cab-tab-content-item\u7684\u6570\u91CF\u4E0D\u4E00\u81F4");
      for (let i = 0; i < lis.length; i++) {
        lis[i].onclick = () => {
          for (let j = 0; j < contents.length; j++) {
            lis[j].setAttribute("is_activate", "false");
            contents[j].setAttribute("is_activate", "false");
            contents[j].setAttribute("style", "display:none");
          }
          lis[i].setAttribute("is_activate", "true");
          contents[i].setAttribute("is_activate", "true");
          contents[i].setAttribute("style", "display:block");
        };
      }
    }
    return div;
  }
  static c2data2items(c2listdata, el) {
    const el_items = document.createElement("div");
    el.appendChild(el_items);
    el_items.classList.add("ab-items");
    let el_item = null;
    for (let item of c2listdata) {
      if (item.level == 0) {
        el_item = document.createElement("div");
        el_items.appendChild(el_item);
        el_item.classList.add("ab-items-item");
        const el_title = document.createElement("div");
        el_item.appendChild(el_title);
        el_title.classList.add("ab-items-title");
        ABConvertManager.getInstance().m_renderMarkdownFn(item.content, el_title);
      } else {
        if (!el_item)
          continue;
        const el_content = document.createElement("div");
        el_item.appendChild(el_content);
        el_content.classList.add("ab-items-content");
        ABConvertManager.getInstance().m_renderMarkdownFn(item.content, el_content);
      }
    }
    return el;
  }
};
var abc_list2tab = ABConvert.factory({
  id: "list2tab",
  name: "\u5217\u8868\u8F6C\u6807\u7B7E\u680F",
  match: /list2(md)?tab(T)?$/,
  default: "list2mdtab",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/list2(md)?tab(T)?$/);
    if (!matchs)
      return el;
    const c2listData = C2ListProcess.list2c2data(content);
    C2ListProcess.c2data2tab(c2listData, el, matchs[2] == "T");
    return el;
  }
});
var abc_title2tab = ABConvert.factory({
  id: "title2tab",
  name: "\u6807\u9898\u8F6C\u6807\u7B7E\u680F",
  match: "title2tab",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    let data = C2ListProcess.title2c2data(content);
    C2ListProcess.c2data2tab(data, el, false);
    return el;
  }
});
var abc_list2col = ABConvert.factory({
  id: "list2col",
  name: "\u4E00\u7EA7\u5217\u8868\u8F6C\u5206\u680F",
  match: "list2col",
  default: "list2mdtab",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    var _a;
    const c2listData = C2ListProcess.list2c2data(content);
    C2ListProcess.c2data2items(c2listData, el);
    (_a = el.querySelector("div")) == null ? void 0 : _a.classList.add("ab-col");
    return el;
  }
});
var abc_title2col = ABConvert.factory({
  id: "title2col",
  name: "\u6807\u9898\u8F6C\u5206\u680F",
  match: "title2col",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    var _a;
    let data = C2ListProcess.title2c2data(content);
    C2ListProcess.c2data2items(data, el);
    (_a = el.querySelector("div")) == null ? void 0 : _a.classList.add("ab-col");
    return el;
  }
});
var abc_list2card = ABConvert.factory({
  id: "list2card",
  name: "\u5217\u8868\u8F6C\u5361\u7247",
  match: "list2card",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    var _a;
    const c2listData = C2ListProcess.list2c2data(content);
    C2ListProcess.c2data2items(c2listData, el);
    (_a = el.querySelector("div")) == null ? void 0 : _a.classList.add("ab-card");
    return el;
  }
});
var abc_title2card = ABConvert.factory({
  id: "title2card",
  name: "\u6807\u9898\u8F6C\u5361\u7247",
  match: "title2card",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    var _a;
    console.log("title2card", content);
    let data = C2ListProcess.title2c2data(content);
    C2ListProcess.c2data2items(data, el);
    console.log(data, "pp", content);
    (_a = el.querySelector("div")) == null ? void 0 : _a.classList.add("ab-card");
    return el;
  }
});

// src/ABConverter/converter/abc_table.ts
var TableProcess = class {
  static list2table(text, div, modeT = false) {
    let list_itemInfo = ListProcess.list2data(text);
    return TableProcess.data2table(list_itemInfo, div, modeT);
  }
  static list2ut(text, div, modeT = false) {
    let data = ListProcess.list2data(text);
    data = ListProcess.data2strict(data);
    data = C2ListProcess.data_mL_2_2L(data);
    data = ListProcess.data_2L_2_mL1B(data);
    return TableProcess.data2table(data, div, modeT);
  }
  static list2timeline(text, div, modeT = false) {
    let data = ListProcess.list2data(text);
    data = ListProcess.data2strict(data);
    data = C2ListProcess.data_mL_2_2L(data);
    div = TableProcess.data2table(data, div, modeT);
    const table = div.querySelector("table");
    if (table)
      table.classList.add("ab-table-fc", "ab-table-timeline");
    return div;
  }
  static data2table(list_itemInfo, div, modeT) {
    let list_tableInfo = [];
    let prev_line = -1;
    let prev_level = 999;
    for (let i = 0; i < list_itemInfo.length; i++) {
      let item = list_itemInfo[i];
      let tableRow = 1;
      let row_level = list_itemInfo[i].level;
      for (let j = i + 1; j < list_itemInfo.length; j++) {
        if (list_itemInfo[j].level > row_level) {
          row_level = list_itemInfo[j].level;
        } else if (list_itemInfo[j].level > list_itemInfo[i].level) {
          row_level = list_itemInfo[j].level;
          tableRow++;
        } else
          break;
      }
      if (item.level <= prev_level) {
        prev_line++;
      }
      prev_level = item.level;
      list_tableInfo.push({
        content: item.content,
        level: item.level,
        tableRowSpan: tableRow,
        tableRow: prev_line
      });
    }
    {
      const table = document.createElement("table");
      div.appendChild(table);
      table.classList.add("ab-table", "ab-branch-table");
      if (modeT)
        table.setAttribute("modeT", "true");
      let thead;
      if (list_tableInfo[0].content.indexOf("< ") == 0) {
        thead = document.createElement("thead");
        table.appendChild(thead);
        list_tableInfo[0].content = list_tableInfo[0].content.replace(/^\<\s/, "");
      }
      const tbody = document.createElement("tbody");
      table.appendChild(tbody);
      for (let index_line = 0; index_line < prev_line + 1; index_line++) {
        let is_head;
        let tr;
        if (index_line == 0 && thead) {
          tr = document.createElement("tr");
          thead.appendChild(tr);
          is_head = true;
        } else {
          is_head = false;
          tr = document.createElement("tr");
          tbody.appendChild(tr);
        }
        for (let item of list_tableInfo) {
          if (item.tableRow != index_line)
            continue;
          let td = document.createElement(is_head ? "th" : "td");
          tr.appendChild(td);
          td.setAttribute("rowspan", item.tableRowSpan.toString());
          td.setAttribute("col_index", item.level.toString());
          td.classList.add("markdown-rendered");
          ABConvertManager.getInstance().m_renderMarkdownFn(item.content, td);
        }
      }
    }
    return div;
  }
};
var abc_title2table = ABConvert.factory({
  id: "title2table",
  name: "\u6807\u9898\u5230\u8868\u683C",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    content = ListProcess.title2list(content, el);
    TableProcess.list2table(content, el);
    return el;
  }
});
var abc_list2table = ABConvert.factory({
  id: "list2table",
  name: "\u5217\u8868\u8F6C\u8868\u683C",
  match: /list2(md)?table(T)?/,
  default: "list2table",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/list2(md)?table(T)?/);
    if (!matchs)
      return el;
    TableProcess.list2table(content, el, matchs[2] == "T");
    return el;
  }
});
var abc_list2c2table = ABConvert.factory({
  id: "list2c2t",
  name: "\u5217\u8868\u8F6C\u4E8C\u5217\u8868\u683C",
  match: "list2c2t",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    let data = C2ListProcess.list2c2data(content);
    TableProcess.data2table(data, el, false);
    return el;
  }
});
var abc_list2ut = ABConvert.factory({
  id: "list2ut",
  name: "\u5217\u8868\u8F6C\u4E8C\u7EF4\u8868\u683C",
  match: /list2(md)?ut(T)?/,
  default: "list2ut",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/list2(md)?ut(T)?/);
    if (!matchs)
      return el;
    TableProcess.list2ut(content, el, matchs[2] == "T");
    return el;
  }
});
var abc_list2timeline = ABConvert.factory({
  id: "list2timeline",
  name: "\u5217\u8868\u8F6C\u65F6\u95F4\u7EBF",
  match: /list2(md)?timeline(T)?/,
  default: "list2mdtimeline",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/list2(md)?timeline(T)?/);
    if (!matchs)
      return el;
    TableProcess.list2timeline(content, el, matchs[2] == "T");
    return el;
  }
});

// src/ABConverter/converter/abc_dir_tree.ts
var DirProcess = class {
  static list2lt(text, div, modeT = false) {
    let list_itemInfo = DirProcess.list2dtdata(text);
    list_itemInfo = ListProcess.data2strict(list_itemInfo).map((item, index) => {
      return {
        content: list_itemInfo[index].content,
        level: item.level,
        tableRow: list_itemInfo[index].tableRow,
        tableColumn: list_itemInfo[index].tableColumn,
        tableRowSpan: list_itemInfo[index].tableRowSpan,
        type: list_itemInfo[index].type
      };
    });
    return DirProcess.dtdata2dt(list_itemInfo, div, modeT);
  }
  static list2dt(text, div, modeT = false) {
    let list_itemInfo = DirProcess.list2dtdata(text);
    list_itemInfo = ListProcess.data2strict(list_itemInfo).map((item, index) => {
      return {
        content: list_itemInfo[index].content,
        level: item.level,
        tableRow: list_itemInfo[index].tableRow,
        tableColumn: list_itemInfo[index].tableColumn,
        tableRowSpan: list_itemInfo[index].tableRowSpan,
        type: list_itemInfo[index].type
      };
    });
    return DirProcess.dtdata2dt(list_itemInfo, div, modeT, true);
  }
  static list2dtdata(text) {
    let list_itemInfo = [];
    const list_text = text.split("\n");
    let row_index = -1;
    for (let line of list_text) {
      const m_line = line.match(ABReg.reg_list_noprefix);
      if (m_line) {
        row_index++;
        const content = m_line[4];
        let level_inline = m_line[1].length;
        list_itemInfo.push({
          content: content.trimStart(),
          level: level_inline,
          tableRow: row_index,
          tableColumn: 0,
          type: "",
          tableRowSpan: 1
        });
      } else {
        let itemInfo = list_itemInfo.pop();
        if (itemInfo) {
          list_itemInfo.push({
            content: itemInfo.content + "\n" + line.trim(),
            level: itemInfo.level,
            tableRow: itemInfo.tableRow,
            tableColumn: itemInfo.tableColumn,
            type: itemInfo.type,
            tableRowSpan: itemInfo.tableRowSpan
          });
        }
      }
    }
    let list_itemInfo2 = [];
    for (let row_item of list_itemInfo) {
      let list_column_item = row_item.content.split(ABReg.inline_split);
      for (let column_index = 0; column_index < list_column_item.length; column_index++) {
        let type = "";
        if (column_index == 0) {
          if (list_column_item[column_index].trimEnd().endsWith("/")) {
            type = "folder";
          } else {
            const parts = list_column_item[column_index].split(".");
            if (parts.length === 0 || parts[parts.length - 1] === "")
              type = "";
            else
              type = parts[parts.length - 1];
          }
        }
        list_itemInfo2.push({
          content: list_column_item[column_index],
          level: row_item.level,
          tableRow: row_index,
          tableColumn: column_index,
          type,
          tableRowSpan: row_item.tableRowSpan
        });
      }
    }
    return list_itemInfo2;
  }
  static dtdata2dt(list_tableInfo, div, modeT, is_folder = false) {
    {
      const table = document.createElement("table");
      div.appendChild(table);
      table.classList.add("ab-table", "ab-list-table");
      if (is_folder)
        table.classList.add("ab-table-folder");
      if (modeT)
        table.setAttribute("modeT", "true");
      let thead, tbody;
      {
        if (list_tableInfo[0].content.indexOf("< ") == 0) {
          thead = document.createElement("thead");
          table.appendChild(thead);
          list_tableInfo[0].content = list_tableInfo[0].content.replace(/^\<\s/, "");
        }
        tbody = document.createElement("tbody");
        table.appendChild(tbody);
      }
      let tr;
      let is_head = false;
      let prev_tr = null;
      for (let cell_index = 0; cell_index < list_tableInfo.length; cell_index++) {
        const cell_item = list_tableInfo[cell_index];
        if (cell_item.tableColumn == 0) {
          if (cell_index == 0 && thead) {
            is_head = true;
            tr = document.createElement("tr");
            thead.appendChild(tr);
          } else {
            is_head = false;
            tr = document.createElement("tr");
            tbody.appendChild(tr);
            tr.classList.add("ab-foldable-tr");
            tr.setAttribute("tr_level", cell_item.level.toString());
            tr.setAttribute("is_fold", "false");
            tr.setAttribute("able_fold", "false");
            tr.setAttribute("type", cell_item.type);
          }
          if (prev_tr && !isNaN(Number(prev_tr.getAttribute("tr_level"))) && Number(prev_tr.getAttribute("tr_level")) < cell_item.level) {
            prev_tr.setAttribute("able_fold", "true");
          }
          prev_tr = tr;
        }
        let td = document.createElement(is_head ? "th" : "td");
        tr.appendChild(td);
        td.setAttribute("rowspan", cell_item.tableRowSpan.toString());
        if (cell_item.tableColumn == 0 && is_folder) {
          let td_svg = document.createElement("div");
          td.appendChild(td_svg);
          td_svg.classList.add("ab-list-table-svg");
          if (!is_head) {
            if (cell_item.type == "folder") {
              td_svg.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"/></svg>`;
              cell_item.content = cell_item.content.slice(0, -1);
            } else {
              td_svg.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M320 464c8.8 0 16-7.2 16-16l0-288-80 0c-17.7 0-32-14.3-32-32l0-80L64 48c-8.8 0-16 7.2-16 16l0 384c0 8.8 7.2 16 16 16l256 0zM0 64C0 28.7 28.7 0 64 0L229.5 0c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64z"/></svg>`;
            }
          }
        }
        let td_cell = document.createElement("div");
        td.appendChild(td_cell);
        td_cell.classList.add("ab-list-table-witharrow");
        ABConvertManager.getInstance().m_renderMarkdownFn(cell_item.content, td_cell);
      }
      const l_tr = tbody.querySelectorAll("tr");
      for (let i = 0; i < l_tr.length; i++) {
        const tr2 = l_tr[i];
        tr2.onclick = () => {
          const tr_level = Number(tr2.getAttribute("tr_level"));
          if (isNaN(tr_level))
            return;
          const tr_isfold = tr2.getAttribute("is_fold");
          if (!tr_isfold)
            return;
          let flag_do_fold = false;
          for (let j = i + 1; j < l_tr.length; j++) {
            const tr22 = l_tr[j];
            const tr_level2 = Number(tr22.getAttribute("tr_level"));
            if (isNaN(tr_level2))
              break;
            if (tr_level2 <= tr_level)
              break;
            tr_isfold == "true" ? tr22.style.display = "" : tr22.style.display = "none";
            flag_do_fold = true;
          }
          if (flag_do_fold)
            tr2.setAttribute("is_fold", tr_isfold == "true" ? "false" : "true");
        };
      }
    }
    return div;
  }
};
var abc_list2lt = ABConvert.factory({
  id: "list2lt",
  name: "\u5217\u8868\u8F6C\u5217\u8868\u8868\u683C",
  match: /list2(md)?lt(T)?/,
  default: "list2lt",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/list2(md)?lt(T)?/);
    if (!matchs)
      return el;
    DirProcess.list2lt(content, el, matchs[2] == "T");
    return el;
  }
});
var abc_list2dt = ABConvert.factory({
  id: "list2dt",
  name: "\u5217\u8868\u8F6C\u6811\u72B6\u76EE\u5F55",
  match: /list2(md)?dt(T)?/,
  default: "list2dt",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/list2(md)?dt(T)?/);
    if (!matchs)
      return el;
    DirProcess.list2dt(content, el, matchs[2] == "T");
    return el;
  }
});
function listdata2dirdata(list) {
  let is_have_vbar = [];
  let newlist = [];
  for (let i = 0; i < list.length; i++) {
    let item = list[i];
    let type;
    if (item.content.endsWith("/")) {
      type = "folder";
    } else {
      const parts = item.content.split(".");
      if (parts.length === 0 || parts[parts.length - 1] === "")
        type = "";
      else
        type = parts[parts.length - 1];
    }
    let is_last = true;
    for (let j = i + 1; j < list.length; j++) {
      if (list[j].level < item.level) {
        is_last = true;
        break;
      } else if (list[j].level == item.level) {
        is_last = false;
        break;
      } else {
        continue;
      }
    }
    is_have_vbar[item.level] = !is_last;
    let pre_as_text = "";
    if (item.level > 1) {
      for (let i2 = 1; i2 < item.level; i2++) {
        if (!is_have_vbar.hasOwnProperty(i2))
          pre_as_text += "[e]";
        else if (is_have_vbar[i2])
          pre_as_text += "|  ";
        else
          pre_as_text += "   ";
      }
    }
    newlist.push({
      content: item.content,
      level: item.level,
      type,
      is_last,
      pre_as_text
    });
  }
  return newlist;
}
var abc_list2astreeH = ABConvert.factory({
  id: "list2astreeH",
  name: "\u5217\u8868\u5230sacii\u76EE\u5F55\u6811",
  process_param: "string" /* text */,
  process_return: "string" /* text */,
  process: (el, header, content) => {
    let listdata = ListProcess.list2data(content);
    listdata = ListProcess.data2strict(listdata);
    const dirlistdata = listdata2dirdata(listdata);
    let newContent = "";
    for (let item of dirlistdata) {
      if (item.level == 0) {
        newContent += item.content + "\n";
      } else {
        newContent += item.pre_as_text + (item.is_last ? "\u2514\u2500 " : "\u251C\u2500 ") + item.content + "\n";
      }
    }
    newContent = newContent.trimEnd();
    return newContent;
  }
});

// src/ABConverter/converter/abc_deco.ts
var abc_md = ABConvert.factory({
  id: "md",
  name: "md",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const subEl = document.createElement("div");
    el.appendChild(subEl);
    ABConvertManager.getInstance().m_renderMarkdownFn(content, subEl);
    return el;
  }
});
var abc_text = ABConvert.factory({
  id: "text",
  name: "\u7EAF\u6587\u672C",
  detail: "\u5176\u5B9E\u4E00\u822C\u4F1A\u66F4\u63A8\u8350\u7528code()\u4EE3\u66FF\uFF0C\u90A3\u4E2A\u66F4\u7CBE\u786E",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    el.innerHTML = `<p>${content.replace(/ /g, "&nbsp;").split("\n").join("<br/>")}</p>`;
    return el;
  }
});
var abc_fold = ABConvert.factory({
  id: "fold",
  name: "\u6298\u53E0",
  process_param: "HTMLElement" /* el */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    if (el.children.length != 1)
      return el;
    const sub_el = el.children[0];
    sub_el.remove();
    sub_el.setAttribute("is_hide", "true");
    sub_el.classList.add("ab-deco-fold-content");
    sub_el.style.display = "none";
    const mid_el = document.createElement("div");
    el.appendChild(mid_el);
    mid_el.classList.add("ab-deco-fold");
    const sub_button = document.createElement("div");
    mid_el.appendChild(sub_button);
    sub_button.classList.add("ab-deco-fold-button");
    sub_button.textContent = "\u5C55\u5F00";
    sub_button.onclick = () => {
      const is_hide = sub_el.getAttribute("is_hide");
      if (is_hide && is_hide == "false") {
        sub_el.setAttribute("is_hide", "true");
        sub_el.style.display = "none";
        sub_button.textContent = "\u5C55\u5F00";
      } else if (is_hide && is_hide == "true") {
        sub_el.setAttribute("is_hide", "false");
        sub_el.style.display = "";
        sub_button.textContent = "\u6298\u53E0";
      }
    };
    mid_el.appendChild(sub_button);
    mid_el.appendChild(sub_el);
    return el;
  }
});
var abc_scroll = ABConvert.factory({
  id: "scroll",
  name: "\u6EDA\u52A8",
  match: /^scroll(\((\d+)\))?(T)?$/,
  default: "scroll(460)",
  process_param: "HTMLElement" /* el */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/^scroll(\((\d+)\))?(T)?$/);
    if (!matchs)
      return el;
    let arg1;
    if (!matchs[1])
      arg1 = 460;
    else {
      if (!matchs[2])
        return el;
      arg1 = Number(matchs[2]);
      if (isNaN(arg1))
        return;
    }
    if (el.children.length != 1)
      return el;
    const sub_el = el.children[0];
    sub_el.remove();
    const mid_el = document.createElement("div");
    el.appendChild(mid_el);
    mid_el.classList.add("ab-deco-scroll");
    if (!matchs[3]) {
      mid_el.classList.add("ab-deco-scroll-y");
      mid_el.setAttribute("style", `max-height: ${arg1}px`);
    } else {
      mid_el.classList.add("ab-deco-scroll-x");
    }
    mid_el.appendChild(sub_el);
    return el;
  }
});
var abc_overfold = ABConvert.factory({
  id: "overfold",
  name: "\u8D85\u51FA\u6298\u53E0",
  match: /^overfold(\((\d+)\))?$/,
  default: "overfold(380)",
  process_param: "HTMLElement" /* el */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/^overfold(\((\d+)\))?$/);
    if (!matchs)
      return el;
    let arg1;
    if (!matchs[1])
      arg1 = 460;
    else {
      if (!matchs[2])
        return el;
      arg1 = Number(matchs[2]);
      if (isNaN(arg1))
        return;
    }
    if (el.children.length != 1)
      return el;
    const sub_el = el.children[0];
    sub_el.remove();
    const mid_el = document.createElement("div");
    el.appendChild(mid_el);
    mid_el.classList.add("ab-deco-overfold");
    const sub_button = document.createElement("div");
    mid_el.appendChild(sub_button);
    sub_button.classList.add("ab-deco-overfold-button");
    sub_button.textContent = "\u5C55\u5F00";
    sub_el.classList.add("ab-deco-overfold-content");
    mid_el.appendChild(sub_el);
    mid_el.appendChild(sub_button);
    mid_el.setAttribute("style", `max-height: ${arg1}px`);
    mid_el.setAttribute("is-fold", "true");
    sub_button.onclick = () => {
      const is_fold = mid_el.getAttribute("is-fold");
      if (!is_fold)
        return;
      if (is_fold == "true") {
        mid_el.setAttribute("style", "");
        mid_el.setAttribute("is-fold", "false");
        sub_button.textContent = "\u6298\u53E0";
      } else {
        mid_el.setAttribute("style", `max-height: ${arg1}px`);
        mid_el.setAttribute("is-fold", "true");
        sub_button.textContent = "\u5C55\u5F00";
      }
    };
    return el;
  }
});
var abc_addClass = ABConvert.factory({
  id: "addClass",
  name: "\u589E\u52A0class",
  detail: "\u7ED9\u5F53\u524D\u5757\u589E\u52A0\u4E00\u4E2A\u7C7B\u540D",
  match: /^addClass\((.*)\)$/,
  process_param: "HTMLElement" /* el */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/^addClass\((.*)\)$/);
    if (!matchs || !matchs[1])
      return el;
    if (el.children.length != 1)
      return el;
    const sub_el = el.children[0];
    sub_el.classList.add(String(matchs[1]));
    return el;
  }
});
var abc_addDiv = ABConvert.factory({
  id: "addDiv",
  name: "\u589E\u52A0div\u548Cclass",
  detail: "\u7ED9\u5F53\u524D\u5757\u589E\u52A0\u4E00\u4E2A\u7236\u7C7B\uFF0C\u9700\u8981\u7ED9\u8FD9\u4E2A\u7236\u7C7B\u4E00\u4E2A\u7C7B\u540D",
  match: /^addDiv\((.*)\)$/,
  process_param: "HTMLElement" /* el */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/^addDiv\((.*)\)$/);
    if (!matchs || !matchs[1])
      return el;
    const arg1 = matchs[1];
    if (el.children.length != 1)
      return el;
    const sub_el = el.children[0];
    sub_el.remove();
    const mid_el = document.createElement("div");
    el.appendChild(mid_el);
    mid_el.classList.add(arg1);
    mid_el.appendChild(sub_el);
    return el;
  }
});
var abc_heimu = ABConvert.factory({
  id: "heimu",
  name: "\u9ED1\u5E55",
  detail: "\u548C\u840C\u5A18\u767E\u79D1\u7684\u9ED1\u5E55\u6548\u679C\u76F8\u4F3C",
  process_alias: "addClass(ab-deco-heimu)",
  process: (el, header, content) => {
  }
});
var abc_title = ABConvert.factory({
  id: "title",
  name: "\u6807\u9898",
  match: /^#(.*)/,
  detail: "\u82E5\u76F4\u63A5\u5904\u7406\u4EE3\u7801\u6216\u8868\u683C\u5757\uFF0C\u5219\u4F1A\u6709\u7279\u6B8A\u98CE\u683C",
  process_param: "HTMLElement" /* el */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const matchs = header.match(/^#(.*)/);
    if (!matchs || !matchs[1])
      return el;
    const arg1 = matchs[1];
    if (el.children.length != 1)
      return el;
    const sub_el = el.children[0];
    sub_el.remove();
    sub_el.classList.add("ab-deco-title-content");
    const mid_el = document.createElement("div");
    el.appendChild(mid_el);
    mid_el.classList.add("ab-deco-title");
    const sub_title = document.createElement("div");
    mid_el.appendChild(sub_title);
    sub_title.classList.add("ab-deco-title-title");
    const p_el = document.createElement("p");
    sub_title.appendChild(p_el);
    p_el.textContent = arg1;
    mid_el.appendChild(sub_title);
    mid_el.appendChild(sub_el);
    let title_type = "none";
    if (sub_el instanceof HTMLQuoteElement) {
      title_type = "quote";
    } else if (sub_el instanceof HTMLTableElement) {
      title_type = "table";
    } else if (sub_el instanceof HTMLPreElement) {
      title_type = "pre";
      () => {
        console.log("style1", window.getComputedStyle(sub_el, null), "style2", window.getComputedStyle(sub_el, null).getPropertyValue("background-color"), "style3", window.getComputedStyle(sub_el, null).getPropertyValue("background"), "style4", window.getComputedStyle(sub_el, null).backgroundColor, "style5", window.getComputedStyle(sub_el, null).background);
        let color = window.getComputedStyle(sub_el, null).getPropertyValue("background-color");
        if (color)
          sub_title.setAttribute("style", `background-color:${color}`);
        else {
          color = window.getComputedStyle(sub_el, null).getPropertyValue("background");
          sub_title.setAttribute("style", `background:${color}`);
        }
      };
    } else if (sub_el instanceof HTMLUListElement) {
      title_type = "ul";
    }
    sub_title.setAttribute("title-type", title_type);
    return el;
  }
});

// src/ABConverter/converter/abc_ex.ts
var abc_faq = ABConvert.factory({
  id: "faq",
  name: "FAQ",
  match: "FAQ",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const e_faq = document.createElement("div");
    el.appendChild(e_faq);
    e_faq.classList.add("ab-faq");
    const list_content = content.split("\n");
    let mode_qa = "";
    let last_content = "";
    for (let line of list_content) {
      const m_line = line.match(/^([a-zA-Z])(: |)(.*)/);
      if (!m_line) {
        if (mode_qa) {
          last_content = last_content + "\n" + line;
        }
        continue;
      } else {
        if (mode_qa) {
          const e_faq_line = document.createElement("div");
          e_faq.appendChild(e_faq_line);
          e_faq_line.classList.add("ab-faq-line", `ab-faq-${mode_qa}`);
          const e_faq_bubble = document.createElement("div");
          e_faq_line.appendChild(e_faq_bubble);
          e_faq_bubble.classList.add("ab-faq-bubble", `ab-faq-${mode_qa}`);
          const e_faq_content = document.createElement("div");
          e_faq_bubble.appendChild(e_faq_content);
          e_faq_content.classList.add("ab-faq-content");
          ABConvertManager.getInstance().m_renderMarkdownFn(last_content, e_faq_content);
        }
        mode_qa = m_line[1];
        last_content = m_line[3];
      }
    }
    if (mode_qa) {
      const e_faq_line = document.createElement("div");
      e_faq.appendChild(e_faq_line);
      e_faq_line.classList.add("ab-faq-line", `ab-faq-${mode_qa}`);
      const e_faq_bubble = document.createElement("div");
      e_faq_line.appendChild(e_faq_bubble);
      e_faq_bubble.classList.add("ab-faq-bubble", `ab-faq-${mode_qa}`);
      const e_faq_content = document.createElement("div");
      e_faq_bubble.appendChild(e_faq_content);
      e_faq_content.classList.add("ab-faq-content");
      e_faq_content.classList.add("markdown-rendered");
      ABConvertManager.getInstance().m_renderMarkdownFn(last_content, e_faq_content);
    }
    return el;
  }
});
var abc_info = ABConvert.factory({
  id: "info",
  name: "INFO",
  match: "info",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const table_p = document.createElement("div");
    el.appendChild(table_p);
    table_p.classList.add("markdown-rendered", "ab-setting", "md-table-fig1");
    const table = document.createElement("table");
    table_p.appendChild(table);
    table.classList.add("ab-setting", "md-table-fig2");
    {
      const thead = document.createElement("thead");
      table.appendChild(thead);
      const tr = document.createElement("tr");
      thead.appendChild(tr);
      let th;
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u5904\u7406\u5668\u540D";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u4E0B\u62C9\u6846\u9ED8\u8BA4\u9879";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u7528\u9014\u63CF\u8FF0";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u5904\u7406\u7C7B\u578B";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u8F93\u51FA\u7C7B\u578B";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u6B63\u5219";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u522B\u540D\u66FF\u6362";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u662F\u5426\u542F\u7528";
      th = document.createElement("th");
      tr.appendChild(th);
      th.textContent = "\u5B9A\u4E49\u6765\u6E90";
    }
    const tbody = document.createElement("tbody");
    table.appendChild(tbody);
    for (let item of ABConvertManager.getInstance().list_abConvert) {
      const tr = document.createElement("tr");
      tbody.appendChild(tr);
      let td;
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = item.name;
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = String(item.default);
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = item.detail;
      td.setAttribute("style", "max-width:240px;overflow-x:auto;white-space:nowrap;");
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = String(item.process_param);
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = String(item.process_return);
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = String(item.match);
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = item.process_alias;
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = item.is_disable ? "\u7981\u7528" : "\u542F\u7528";
      td = document.createElement("td");
      tr.appendChild(td);
      td.textContent = item.register_from;
    }
    return el;
  }
});

// node_modules/svelte/internal/index.mjs
function noop() {
}
function run(fn) {
  return fn();
}
function run_all(fns) {
  fns.forEach(run);
}
function is_function(thing) {
  return typeof thing === "function";
}
function is_empty(obj) {
  return Object.keys(obj).length === 0;
}
var resolved_promise = Promise.resolve();
var globals = typeof window !== "undefined" ? window : typeof globalThis !== "undefined" ? globalThis : global;
function destroy_component(component, detaching) {
  const $$ = component.$$;
  if ($$.fragment !== null) {
    run_all($$.on_destroy);
    $$.fragment && $$.fragment.d(detaching);
    $$.on_destroy = $$.fragment = null;
    $$.ctx = [];
  }
}
var SvelteElement;
if (typeof HTMLElement === "function") {
  SvelteElement = class extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: "open" });
    }
    connectedCallback() {
      const { on_mount } = this.$$;
      this.$$.on_disconnect = on_mount.map(run).filter(is_function);
      for (const key in this.$$.slotted) {
        this.appendChild(this.$$.slotted[key]);
      }
    }
    attributeChangedCallback(attr, _oldValue, newValue) {
      this[attr] = newValue;
    }
    disconnectedCallback() {
      run_all(this.$$.on_disconnect);
    }
    $destroy() {
      destroy_component(this, 1);
      this.$destroy = noop;
    }
    $on(type, callback) {
      if (!is_function(callback)) {
        return noop;
      }
      const callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);
      callbacks.push(callback);
      return () => {
        const index = callbacks.indexOf(callback);
        if (index !== -1)
          callbacks.splice(index, 1);
      };
    }
    $set($$props) {
      if (this.$$set && !is_empty($$props)) {
        this.$$.skip_bound = true;
        this.$$set($$props);
        this.$$.skip_bound = false;
      }
    }
  };
}

// src/ABConverter/converter/abc_mdit_container.ts
function mditTabs2listdata(content, reg) {
  let list_line = content.split("\n");
  let content_item = "";
  let list_c2listItem = [];
  for (let line_index = 0; line_index < list_line.length; line_index++) {
    let line_content = list_line[line_index];
    const line_match = line_content.match(reg);
    if (line_match) {
      add_current_content();
      list_c2listItem.push({
        content: line_match[1].trim(),
        level: 0
      });
      continue;
    } else {
      content_item += line_content + "\n";
    }
  }
  add_current_content();
  return list_c2listItem;
  function add_current_content() {
    if (content_item.trim() == "")
      return;
    list_c2listItem.push({
      content: content_item,
      level: 1
    });
    content_item = "";
  }
}
var abc_mditTabs = ABConvert.factory({
  id: "mditTabs",
  name: "mdit\u6807\u7B7E\u9875",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    let c2listdata = mditTabs2listdata(content, /^@tab(.*)$/);
    C2ListProcess.c2data2tab(c2listdata, el, false);
    return el;
  }
});
var abc_mditDemo = ABConvert.factory({
  id: "mditDemo",
  name: "mdit\u5C55\u793A\u5BF9\u6BD4",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const newContent = `@tab show
${content}
@tab mdSource
~~~~~md
${content}
~~~~~`;
    abc_mditTabs.process(el, header, newContent);
    return el;
  }
});
var abc_mditABDemo = ABConvert.factory({
  id: "mditABDemo",
  name: "AnyBlock\u8F6C\u7528\u5C55\u793A\u5BF9\u6BD4",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    const newContent = `@tab show
${content}
@tab withoutPlugin
(noPlugin)${content.trimStart()}
@tab mdSource
~~~~~md
${content}
~~~~~`;
    abc_mditTabs.process(el, header, newContent);
    return el;
  }
});
var abc_midt_co = ABConvert.factory({
  id: "mditCol",
  name: "mdit\u5206\u680F",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    var _a;
    let c2listdata = mditTabs2listdata(content, /^@[a-zA-Z](.*)$/);
    C2ListProcess.c2data2items(c2listdata, el);
    (_a = el.querySelector("div")) == null ? void 0 : _a.classList.add("ab-col");
    return el;
  }
});
var abc_midt_card = ABConvert.factory({
  id: "mditCard",
  name: "mdit\u5361\u7247",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    var _a;
    let c2listdata = mditTabs2listdata(content, /^@[a-zA-Z](.*)$/);
    C2ListProcess.c2data2items(c2listdata, el);
    (_a = el.querySelector("div")) == null ? void 0 : _a.classList.add("ab-card");
    return el;
  }
});

// src/ABConverter/converter/abc_mermaid.ts
var abc_title2mindmap = ABConvert.factory({
  id: "title2mindmap",
  name: "\u6807\u9898\u5230\u8111\u56FE",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    content = ListProcess.title2list(content, el);
    list2mindmap(content, el);
    return el;
  }
});
var abc_list2mermaid = ABConvert.factory({
  id: "list2mermaid",
  name: "\u5217\u8868\u8F6Cmermaid\u6D41\u7A0B\u56FE",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    list2mermaid(content, el);
    return el;
  }
});
var abc_list2mindmap = ABConvert.factory({
  id: "list2mindmap",
  name: "\u5217\u8868\u8F6Cmermaid\u601D\u7EF4\u5BFC\u56FE",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    list2mindmap(content, el);
    return el;
  }
});
var abc_mermaid = ABConvert.factory({
  id: "mermaid",
  name: "\u65B0mermaid",
  match: /^mermaid(\((.*)\))?$/,
  default: "mermaid(graph TB)",
  detail: "\u7531\u4E8E\u9700\u8981\u517C\u5BB9\u8111\u56FE\uFF0C\u8FD9\u91CC\u4F1A\u4F7F\u7528\u63D2\u4EF6\u5185\u7F6E\u7684\u6700\u65B0\u7248mermaid",
  process_param: "string" /* text */,
  process_return: "HTMLElement" /* el */,
  process: (el, header, content) => {
    let matchs = content.match(/^mermaid(\((.*)\))?$/);
    if (!matchs)
      return el;
    if (matchs[1])
      content = matchs[2] + "\n" + content;
    return render_mermaidText(content, el);
  }
});
function list2mermaid(text, div) {
  let list_itemInfo = ListProcess.list2data(text);
  let mermaidText = data2mermaidText(list_itemInfo);
  return render_mermaidText(mermaidText, div);
}
function list2mindmap(text, div) {
  let list_itemInfo = ListProcess.list2data(text);
  return data2mindmap(list_itemInfo, div);
}
function data2mermaidText(list_itemInfo) {
  const html_mode = false;
  let list_line_content = ["graph LR"];
  let prev_line_content = "";
  let prev_level = 999;
  for (let i = 0; i < list_itemInfo.length; i++) {
    if (list_itemInfo[i].level > prev_level) {
      prev_line_content = prev_line_content + " --> " + list_itemInfo[i].content;
    } else {
      list_line_content.push(prev_line_content);
      prev_line_content = "";
      for (let j = i; j >= 0; j--) {
        if (list_itemInfo[j].level < list_itemInfo[i].level) {
          prev_line_content = list_itemInfo[j].content;
          break;
        }
      }
      if (prev_line_content)
        prev_line_content = prev_line_content + " --> ";
      prev_line_content = prev_line_content + list_itemInfo[i].content;
    }
    prev_level = list_itemInfo[i].level;
  }
  list_line_content.push(prev_line_content);
  let text = list_line_content.join("\n");
  return text;
}
async function data2mindmap(list_itemInfo, div) {
  let list_newcontent = [];
  for (let item of list_itemInfo) {
    let str_indent = "";
    for (let i = 0; i < item.level; i++)
      str_indent += " ";
    list_newcontent.push(str_indent + item.content.replace("\n", "<br/>"));
  }
  const mermaidText = "mindmap\n" + list_newcontent.join("\n");
  return render_mermaidText(mermaidText, div);
}
async function render_mermaidText(mermaidText, div) {
  ABConvertManager.getInstance().m_renderMarkdownFn("```mermaid\n" + mermaidText + "\n```", div);
  return div;
}

// src/ab_manager/abm_code/ABReplacer_CodeBlock.ts
var import_obsidian = require("obsidian");
var ABReplacer_CodeBlock = class {
  static processor(src, blockEl, ctx) {
    let child = new import_obsidian.MarkdownRenderChild(blockEl);
    ctx.addChild(child);
    blockEl.addClass("markdown-rendered");
    import_obsidian.MarkdownRenderer.renderMarkdown(src, blockEl, ctx.sourcePath, child);
  }
};

// src/ab_manager/abm_cm/ABStateManager.ts
var import_view3 = require("@codemirror/view");
var import_state = require("@codemirror/state");
var import_obsidian3 = require("obsidian");

// src/config/ABSettingTab.ts
var import_obsidian2 = require("obsidian");

// src/config/ABReg.ts
var ABReg5 = {
  reg_header: /^((\s|>\s|-\s|\*\s|\+\s)*)(%%)?(\[((?!toc)(?!TOC)[0-9a-zA-Z\u4e00-\u9fa5].*)\]):?(%%)?\s*$/,
  reg_mdit_head: /^((\s|>\s|-\s|\*\s|\+\s)*)(:::)\s?(.*)/,
  reg_mdit_tail: /^((\s|>\s|-\s|\*\s|\+\s)*)(:::)/,
  reg_list: /^((\s|>\s|-\s|\*\s|\+\s)*)(-\s|\*\s|\+\s)(.*)/,
  reg_code: /^((\s|>\s|-\s|\*\s|\+\s)*)(```|~~~)(.*)/,
  reg_quote: /^((\s|>\s|-\s|\*\s|\+\s)*)(>\s)(.*)/,
  reg_heading: /^((\s|>\s|-\s|\*\s|\+\s)*)(\#+\s)(.*)/,
  reg_table: /^((\s|>\s|-\s|\*\s|\+\s)*)(\|(.*)\|)/,
  reg_header_noprefix: /^((\s)*)(%%)?(\[((?!toc)(?!TOC)[0-9a-zA-Z\u4e00-\u9fa5].*)\]):?(%%)?\s*$/,
  reg_mdit_head_noprefix: /^((\s)*)(:::)\s?(.*)/,
  reg_mdit_tail_noprefix: /^((\s)*)(:::)/,
  reg_list_noprefix: /^((\s)*)(-\s|\*\s|\+\s)(.*)/,
  reg_code_noprefix: /^((\s)*)(```|~~~)(.*)/,
  reg_quote_noprefix: /^((\s)*)(>\s)(.*)/,
  reg_heading_noprefix: /^((\s)*)(\#+\s)(.*)/,
  reg_table_noprefix: /^((\s)*)(\|(.*)\|)/,
  reg_emptyline_noprefix: /^\s*$/,
  reg_indentline_noprefix: /^\s+?\S/,
  inline_split: /\| |,  | |\.  |:  | /
};

// src/ab_manager/abm_cm/ABSelector_Md.ts
function autoMdSelector(mdText = "") {
  let list_mdSelectorRangeSpec = [];
  let list_text = mdText.split("\n");
  let map_line_ch = [0];
  let count_ch = 0;
  for (let line of list_text) {
    count_ch = count_ch + line.length + 1;
    map_line_ch.push(count_ch);
  }
  for (let i = 0; i < list_text.length; i++) {
    const line = list_text[i];
    for (let selecotr of list_mdSelector) {
      if (selecotr.match.test(line)) {
        let sim = selecotr.selector(list_text, i);
        if (!sim)
          continue;
        list_mdSelectorRangeSpec.push({
          from_ch: map_line_ch[sim.from_line],
          to_ch: map_line_ch[sim.to_line] - 1,
          header: sim.header,
          selector: sim.selector,
          content: sim.content,
          prefix: sim.prefix
        });
        i = sim.to_line - 1;
        break;
      }
    }
  }
  return list_mdSelectorRangeSpec;
}
function generateSelectorInfoTable(el) {
  const table_p = el.createEl("div", {
    cls: ["ab-setting", "md-table-fig1"]
  });
  const table = table_p.createEl("table", {
    cls: ["ab-setting", "md-table-fig2"]
  });
  {
    const thead = table.createEl("thead");
    const tr = thead.createEl("tr");
    tr.createEl("th", { text: "Selector Name" });
    tr.createEl("th", { text: "First-line Regular" });
    tr.createEl("th", { text: "Enable" });
  }
  const tbody = table.createEl("tbody");
  for (let item of list_mdSelector) {
    const tr = tbody.createEl("tr");
    tr.createEl("td", { text: item.name });
    tr.createEl("td", { text: String(item.match) });
    tr.createEl("td", { text: item.is_disable ? "No" : "Yes" });
  }
  return table_p;
}
var list_mdSelector = [];
function registerMdSelector(simp) {
  var _a;
  list_mdSelector.push({
    id: simp.id,
    name: simp.name,
    match: simp.match,
    detail: (_a = simp.detail) != null ? _a : "",
    selector: simp.selector,
    is_disable: false
  });
}

// src/ab_manager/abm_cm/ABSelector_MdBase.ts
function easySelector(list_text, from_line, selector, frist_reg) {
  let mdRange = {
    from_line: from_line - 1,
    to_line: from_line + 1,
    header: "",
    selector,
    levelFlag: "",
    content: "",
    prefix: ""
  };
  if (from_line <= 0)
    return null;
  const first_line_match = list_text[from_line].match(frist_reg);
  if (!first_line_match)
    return null;
  mdRange.prefix = first_line_match[1];
  mdRange.levelFlag = first_line_match[3];
  let header_line_match;
  if (list_text[from_line - 1].indexOf(mdRange.prefix) == 0 && ABReg5.reg_emptyline_noprefix.test(list_text[from_line - 1]) && from_line > 1) {
    mdRange.from_line = from_line - 2;
  }
  header_line_match = list_text[mdRange.from_line].match(ABReg5.reg_header);
  if (!header_line_match)
    return null;
  if (header_line_match[1] != mdRange.prefix)
    return null;
  mdRange.header = header_line_match[5];
  return mdRange;
}
function easySelector_headtail(list_text, from_line, selector, frist_reg) {
  let mdRange = {
    from_line,
    to_line: from_line + 1,
    header: "",
    selector,
    levelFlag: "",
    content: "",
    prefix: ""
  };
  if (from_line <= 0)
    return null;
  const first_line_match = list_text[from_line].match(frist_reg);
  if (!first_line_match)
    return null;
  mdRange.prefix = first_line_match[1];
  mdRange.levelFlag = first_line_match[3];
  mdRange.header = first_line_match[4];
  return mdRange;
}
var mdSelector_headtail = {
  id: "headtail",
  name: "\u5934\u5C3E\u9009\u62E9\u5668",
  detail: "\u4EE5`:::`\u5F00\u5934\u548C\u7ED3\u5C3E\uFF0C\u5904\u7406\u5668\u540D\u5199\u5728\u7B2C\u4E00\u4E2A`:::`\u7684\u540E\u9762\uFF0C\u4E0D\u9700\u8981\u52A0`[]`\u3002\u5176\u5B9E\u5C31\u548C\u4EE3\u7801\u5757\u5DEE\u4E0D\u591A\uFF0C\u8FD9\u4E5F\u662FVuePress\u7684\u4E00\u4E2Amd\u6269\u5C55\u8BED\u6CD5",
  match: ABReg5.reg_mdit_head,
  selector: (list_text, from_line) => {
    let mdRangeTmp = easySelector_headtail(list_text, from_line, "headtail", ABReg5.reg_mdit_head);
    if (!mdRangeTmp)
      return null;
    const mdRange = mdRangeTmp;
    let last_nonempty = from_line;
    for (let i = from_line + 1; i < list_text.length; i++) {
      const line = list_text[i];
      if (line.indexOf(mdRange.prefix) != 0)
        break;
      const line2 = line.replace(mdRange.prefix, "");
      if (ABReg5.reg_emptyline_noprefix.test(line2)) {
        continue;
      }
      last_nonempty = i;
      if (ABReg5.reg_mdit_tail_noprefix.test(line2)) {
        last_nonempty = i;
        break;
      }
    }
    mdRange.to_line = last_nonempty + 1;
    mdRange.content = list_text.slice(from_line + 1, mdRange.to_line - 1).map((line) => {
      return line.replace(mdRange.prefix, "");
    }).join("\n");
    return mdRange;
  }
};
registerMdSelector(mdSelector_headtail);
var mdSelector_list = {
  id: "list",
  name: "\u5217\u8868\u9009\u62E9\u5668",
  match: ABReg5.reg_list,
  detail: "\u5728\u5217\u8868\u7684\u4E0A\u4E00/\u4E24\u884C\u52A0\u4E0A`[\u5904\u7406\u5668\u540D]`\u7684header\uFF0C\u6CE8\u610Fheader\u5FC5\u987B\u548C\u5217\u8868\u9996\u884C\u4F4D\u4E8E\u540C\u4E00\u5C42\u6B21",
  selector: (list_text, from_line) => {
    let mdRangeTmp = easySelector(list_text, from_line, "list", ABReg5.reg_list);
    if (!mdRangeTmp)
      return null;
    const mdRange = mdRangeTmp;
    let last_nonempty = from_line;
    for (let i = from_line + 1; i < list_text.length; i++) {
      const line = list_text[i];
      if (line.indexOf(mdRange.prefix) != 0)
        break;
      const line2 = line.replace(mdRange.prefix, "");
      if (ABReg5.reg_list_noprefix.test(line2)) {
        last_nonempty = i;
        continue;
      }
      if (ABReg5.reg_indentline_noprefix.test(line2)) {
        last_nonempty = i;
        continue;
      }
      if (ABReg5.reg_emptyline_noprefix.test(line2)) {
        continue;
      }
      break;
    }
    mdRange.to_line = last_nonempty + 1;
    mdRange.content = list_text.slice(from_line, mdRange.to_line).map((line) => {
      return line.replace(mdRange.prefix, "");
    }).join("\n");
    return mdRange;
  }
};
registerMdSelector(mdSelector_list);
var mdSelector_code = {
  id: "code",
  name: "\u4EE3\u7801\u9009\u62E9\u5668",
  match: ABReg5.reg_code,
  detail: "\u5728\u4EE3\u7801\u5757\u7684\u4E0A\u4E00/\u4E24\u884C\u52A0\u4E0A`[\u5904\u7406\u5668\u540D]`\u7684header\uFF0C\u6CE8\u610Fheader\u5FC5\u987B\u548C\u4EE3\u7801\u5757\u9996\u884C\u4F4D\u4E8E\u540C\u4E00\u5C42\u6B21",
  selector: (list_text, from_line) => {
    let mdRangeTmp = easySelector(list_text, from_line, "code", ABReg5.reg_code);
    if (!mdRangeTmp)
      return null;
    const mdRange = mdRangeTmp;
    let last_nonempty = from_line;
    for (let i = from_line + 1; i < list_text.length; i++) {
      const line = list_text[i];
      if (line.indexOf(mdRange.prefix) != 0)
        break;
      const line2 = line.replace(mdRange.prefix, "");
      if (ABReg5.reg_emptyline_noprefix.test(line2)) {
        continue;
      }
      last_nonempty = i;
      if (line2.indexOf(mdRange.levelFlag) == 0) {
        last_nonempty = i;
        break;
      }
    }
    mdRange.to_line = last_nonempty + 1;
    mdRange.content = list_text.slice(from_line, mdRange.to_line).map((line) => {
      return line.replace(mdRange.prefix, "");
    }).join("\n");
    return mdRange;
  }
};
registerMdSelector(mdSelector_code);
var mdSelector_quote = {
  id: "quote",
  name: "\u5F15\u7528\u5757\u9009\u62E9\u5668",
  match: ABReg5.reg_quote,
  detail: "\u5728\u5F15\u7528\u5757\u7684\u4E0A\u4E00/\u4E24\u884C\u52A0\u4E0A`[\u5904\u7406\u5668\u540D]`\u7684header\uFF0C\u6CE8\u610Fheader\u5FC5\u987B\u548C\u5F15\u7528\u5757\u9996\u884C\u4F4D\u4E8E\u540C\u4E00\u5C42\u6B21",
  selector: (list_text, from_line) => {
    let mdRangeTmp = easySelector(list_text, from_line, "quote", ABReg5.reg_quote);
    if (!mdRangeTmp)
      return null;
    const mdRange = mdRangeTmp;
    let last_nonempty = from_line;
    for (let i = from_line + 1; i < list_text.length; i++) {
      const line = list_text[i];
      if (line.indexOf(mdRange.prefix) != 0)
        break;
      const line2 = line.replace(mdRange.prefix, "");
      if (ABReg5.reg_quote_noprefix.test(line2)) {
        last_nonempty = i;
        continue;
      }
      break;
    }
    mdRange.to_line = last_nonempty + 1;
    mdRange.content = list_text.slice(from_line, mdRange.to_line).map((line) => {
      return line.replace(mdRange.prefix, "");
    }).join("\n");
    return mdRange;
  }
};
registerMdSelector(mdSelector_quote);
var mdSelector_table = {
  id: "table",
  name: "\u8868\u683C\u9009\u62E9\u5668",
  match: ABReg5.reg_table,
  detail: "\u5728\u8868\u683C\u7684\u4E0A\u4E00/\u4E24\u884C\u52A0\u4E0A`[\u5904\u7406\u5668\u540D]`\u7684header\uFF0C\u6CE8\u610Fheader\u5FC5\u987B\u548C\u8868\u683C\u9996\u884C\u4F4D\u4E8E\u540C\u4E00\u5C42\u6B21",
  selector: (list_text, from_line) => {
    let mdRangeTmp = easySelector(list_text, from_line, "table", ABReg5.reg_table);
    if (!mdRangeTmp)
      return null;
    const mdRange = mdRangeTmp;
    let last_nonempty = from_line;
    for (let i = from_line + 1; i < list_text.length; i++) {
      const line = list_text[i];
      if (line.indexOf(mdRange.prefix) != 0)
        break;
      const line2 = line.replace(mdRange.prefix, "");
      if (ABReg5.reg_table_noprefix.test(line2)) {
        last_nonempty = i;
        continue;
      }
      break;
    }
    mdRange.to_line = last_nonempty + 1;
    mdRange.content = list_text.slice(from_line, mdRange.to_line).map((line) => {
      return line.replace(mdRange.prefix, "");
    }).join("\n");
    return mdRange;
  }
};
registerMdSelector(mdSelector_table);
var mdSelector_heading = {
  id: "heading",
  name: "\u6807\u9898\u9009\u62E9\u5668",
  match: ABReg5.reg_heading,
  detail: "\u5728\u6807\u9898\u7684\u4E0A\u4E00/\u4E24\u884C\u52A0\u4E0A`[\u5904\u7406\u5668\u540D]`\u7684header\uFF0C\u6CE8\u610Fheader\u5FC5\u987B\u548C\u6807\u9898\u9996\u884C\u4F4D\u4E8E\u540C\u4E00\u5C42\u6B21",
  selector: (list_text, from_line) => {
    let mdRangeTmp = easySelector(list_text, from_line, "heading", ABReg5.reg_heading);
    if (!mdRangeTmp)
      return null;
    const mdRange = mdRangeTmp;
    let last_nonempty = from_line;
    for (let i = from_line + 1; i < list_text.length; i++) {
      const line = list_text[i];
      if (line.indexOf(mdRange.prefix) != 0)
        break;
      const line2 = line.replace(mdRange.prefix, "");
      if (ABReg5.reg_emptyline_noprefix.test(line2)) {
        continue;
      }
      const match2 = line2.match(ABReg5.reg_heading_noprefix);
      if (!match2) {
        last_nonempty = i;
        continue;
      }
      if (match2[3].length < mdRange.levelFlag.length) {
        break;
      }
      last_nonempty = i;
    }
    mdRange.to_line = last_nonempty + 1;
    mdRange.content = list_text.slice(from_line, mdRange.to_line).map((line) => {
      return line.replace(mdRange.prefix, "");
    }).join("\n");
    return mdRange;
  }
};
registerMdSelector(mdSelector_heading);

// src/config/ABSettingTab.ts
var AB_SETTINGS = {
  // 
  select_list: "ifhead",      // listifhead
  select_quote: "ifhead",     // quoteifhead
  select_code: "ifhead",      // codeifhead
  select_heading: "ifhead",   // headingifhead
  select_brace: "yes",        // braceyes
  
  decoration_source: "none",  // none
  decoration_live: "block",   // block
  decoration_render: "block", // block
  is_neg_level: false,        //  `<`false ()

  // 
  alias_all: [],              //  (V3.0.8)
  user_processor: [],         //  ()
};
var ABSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
    for (let item of plugin.settings.user_processor) {
      ABConvert.factory(item);
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    let settings = this.plugin.settings;
    containerEl.createEl("h1", { text: "AnyBlock" });
    const div_url = containerEl.createEl("div");
    div_url.innerHTML = `See 
    <a href="https://linczero.github.io/MdNote_Public/ProductDoc/AnyBlock/README.show.html">website</a>
    /
    <a href="https://github.com/LincZero/obsidian-any-block">github</a>
    for more details (\u66F4\u591A\u4F7F\u7528\u65B9\u6CD5\u8BE6\u89C1Github\u53CA\u7F51\u7AD9)
    `;
    containerEl.createEl("hr", { attr: { "style": "border-color:#9999ff" } });
    containerEl.createEl("h2", { text: "Selector Manager (\u9009\u62E9\u5668\u7684\u7BA1\u7406)" });
    containerEl.createEl("p", { text: "This section is for query only and cannot be edited (\u8FD9\u4E00\u90E8\u5206\u4EC5\u4F9B\u67E5\u8BE2\u4E0D\u53EF\u7F16\u8F91)" });
    this.selectorPanel = generateSelectorInfoTable(containerEl);
    containerEl.createEl("hr", { attr: { "style": "border-color:#9999ff" } });
    containerEl.createEl("h2", { text: "AliasSystem Manager (\u522B\u540D\u7CFB\u7EDF\u7684\u7BA1\u7406)" });
    containerEl.createEl("p", { text: "Come will be deprecated in the future! Switch to a new alias system. (\u8BE5\u9879\u672A\u6765\u5C06\u5F03\u7528! \u6362\u7528\u65B0\u7684\u522B\u540D\u7CFB\u7EDF)" });
    containerEl.createEl("p", { text: 'To delete or modify an addition, open the "data.json" file. (\u6DFB\u52A0\u540E\u8981\u5220\u9664\u6216\u4FEE\u6539\u8BF7\u6253\u5F00data.json\u6587\u4EF6.)' });
    new import_obsidian2.Setting(containerEl).setName("Add a new registration instruction").setDesc(`\u6DFB\u52A0\u65B0\u7684\u6CE8\u518C\u6307\u4EE4`).addButton((component) => {
      component.setIcon("plus-circle").onClick((e) => {
        new ABProcessorModal(this.app, async (result) => {
          ABConvert.factory(result);
          settings.user_processor.push(result);
          await this.plugin.saveSettings();
          this.processorPanel.remove();
          const div2 = containerEl.createEl("div");
          ABConvertManager.autoABConvert(div2, "info", "", "null_content");
          this.processorPanel = div2;
        }).open();
      });
    });
    containerEl.createEl("hr", { attr: { "style": "border-color:#9999ff" } });
    containerEl.createEl("h2", { text: "Convertor Manager (\u8F6C\u6362\u5668\u7684\u7BA1\u7406)" });
    containerEl.createEl("p", { text: "This section is for query only and cannot be edited (\u8FD9\u4E00\u90E8\u5206\u4EC5\u4F9B\u67E5\u8BE2\u4E0D\u53EF\u7F16\u8F91)" });
    containerEl.createEl("p", { text: "It can also be viewed in the main page using the `[info]` processor" });
    containerEl.createEl("p", { text: "\u8FD9\u90E8\u5206\u5185\u5BB9\u4E5F\u53EF\u4EE5\u4F7F\u7528 `[info]` \u5904\u7406\u5668\u5728\u4E3B\u9875\u9762\u4E2D\u67E5\u770B" });
    const div = containerEl.createEl("div");
    ABConvertManager.autoABConvert(div, "info", "", "null_content");
    this.processorPanel = div;
  }
};
var ABProcessorModal = class extends import_obsidian2.Modal {
  constructor(app2, onSubmit) {
    super(app2);
    this.args = {
      id: "",
      name: "",
      match: "",
      process_alias: ""
    };
    this.onSubmit = onSubmit;
  }
  onOpen() {
    let { contentEl } = this;
    contentEl.setText("Custom processor (\u81EA\u5B9A\u4E49\u5904\u7406\u5668)");
    contentEl.createEl("p", { text: "" });
    new import_obsidian2.Setting(contentEl).setName("ProcessorId").setDesc("\u5904\u7406\u5668\u552F\u4E00id, \u4E0D\u4E0E\u5176\u4ED6\u5904\u7406\u5668\u51B2\u7A81\u5373\u53EF").addText((text) => {
      text.onChange((value) => {
        this.args.id = value;
      });
    });
    new import_obsidian2.Setting(contentEl).setName("ProcessorName").setDesc("\u6CE8\u518C\u5668\u540D\uFF0C\u53EF\u4EE5\u4E71\u586B\uFF0C\u7ED9\u81EA\u5DF1\u770B\u7684").addText((text) => {
      text.onChange((value) => {
        this.args.name = value;
      });
    });
    new import_obsidian2.Setting(contentEl).setName("Processor matching rule").setDesc("\u6CE8\u518C\u5668\u5339\u914D\u540D (\u7528/\u5305\u62EC\u8D77\u6765\u5219\u8868\u793A\u6B63\u5219)").addText((text) => {
      text.onChange((value) => {
        this.args.match = value;
      });
    });
    new import_obsidian2.Setting(contentEl).setName("Processor replacement").setDesc("\u6CE8\u518C\u5668\u66FF\u6362\u4E3A (\u7528/\u5305\u62EC\u8D77\u6765\u5219\u5224\u65AD\u4E3A\u6B63\u5219)").addText((text) => {
      text.onChange((value) => {
        this.args.process_alias = value;
      });
    });
    new import_obsidian2.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Submit (\u63D0\u4EA4)").setCta().onClick(() => {
        if (this.args.id && this.args.name && this.args.match && this.args.process_alias) {
          this.close();
          this.onSubmit(this.args);
        }
      });
    });
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/ab_manager/abm_cm/ABDecorationManager.ts
var import_view2 = require("@codemirror/view");

// src/ab_manager/abm_cm/ABReplacer_Widget.ts
var import_view = require("@codemirror/view");
var _ABReplacer_Widget = class extends import_view.WidgetType {
  constructor(rangeSpec, editor) {
    super();
    this.rangeSpec = rangeSpec;
    this.global_editor = editor;
  }
  toDOM(view) {
    this.div = document.createElement("div");
    this.div.setAttribute("type_header", this.rangeSpec.header);
    this.div.addClasses(["ab-replace", "cm-embed-block"]);
    let dom_note = this.div.createEl("div", { cls: ["ab-note", "drop-shadow"] });
    ABConvertManager.autoABConvert(dom_note, this.rangeSpec.header, this.rangeSpec.content, this.rangeSpec.selector);
    if (this.global_editor) {
      let dom_edit = this.div.createEl("div", {
        cls: ["ab-button", "edit-block-button"],
        attr: { "aria-label": "Edit this block - " + this.rangeSpec.header }
      });
      dom_edit.innerHTML = _ABReplacer_Widget.str_icon_code2;
      dom_edit.onclick = () => {
        this.moveCursorToHead();
      };
    }
    return this.div;
  }
  moveCursorToHead() {
    if (this.global_editor) {
      const editor = this.global_editor;
      let pos = this.getCursorPos(editor, this.rangeSpec.from_ch);
      if (pos) {
        editor.setCursor(pos);
        editor.replaceRange("OF", pos);
        editor.replaceRange("", pos, { line: pos.line, ch: pos.ch + 2 });
      }
    }
  }
  getCursorPos(editor, total_ch) {
    let count_ch = 0;
    let list_text = editor.getValue().split("\n");
    for (let i = 0; i < list_text.length; i++) {
      if (count_ch + list_text[i].length >= total_ch)
        return { line: i, ch: total_ch - count_ch };
      count_ch = count_ch + list_text[i].length + 1;
    }
    return null;
  }
  createTable(div) {
  }
};
var ABReplacer_Widget = _ABReplacer_Widget;
ABReplacer_Widget.str_icon_code2 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-darkreader-inline-stroke="" style="--darkreader-inline-stroke:currentColor;"><path d="m18 16 4-4-4-4"></path><path d="m6 8-4 4 4 4"></path><path d="m14.5 4-5 16"></path></svg>`;

// src/ab_manager/abm_cm/ABDecorationManager.ts
var ABDecorationManager = class {
  constructor(r_this, rangeSpec, cursorSpec) {
    this.rangeSpec = rangeSpec;
    this.cursorSpec = cursorSpec;
    this.r_this = r_this;
    let from = rangeSpec.from_ch;
    let to = rangeSpec.to_ch;
    let cfrom = cursorSpec.from;
    let cto = cursorSpec.to;
    if (cfrom >= from && cfrom <= to || cto >= from && cto <= to) {
      this.isBlock = false;
    } else {
      this.isBlock = true;
    }
    this.decoration = this.initDecorationSet();
  }
  initDecorationSet() {
    if (!this.isBlock) {
      return import_view2.Decoration.mark({ class: "ab-line-brace" });
    } else {
      return import_view2.Decoration.replace({ widget: new ABReplacer_Widget(this.rangeSpec, this.r_this.editor) });
    }
  }
  static decoration_theme() {
    return [
      import_view2.EditorView.baseTheme({
        ".ab-line-brace": { textDecoration: "underline 1px red" }
      }),
      import_view2.EditorView.baseTheme({
        ".ab-line-list": { textDecoration: "underline 1px cyan" }
      }),
      import_view2.EditorView.baseTheme({
        ".ab-line-yellow": { textDecoration: "solid underline 1px rgba(0, 255, 0, 0.2)" }
      }),
      import_view2.EditorView.baseTheme({
        ".ab-line-blue": { textDecoration: "underline 1px blue" }
      })
    ];
  }
};

// src/ab_manager/abm_cm/ABStateManager.ts
var ABStateManager = class {
  constructor(plugin_this) {
    this.replace_this = this;
    this.decorationField = import_state.StateField.define({
      create: (editorState) => {
        return import_view3.Decoration.none;
      },
      update: (decorationSet, tr) => {
        return this.updateStateField(decorationSet, tr);
      },
      provide: (f) => import_view3.EditorView.decorations.from(f)
    });
    this.plugin_this = plugin_this;
    let ret = this.init();
    console.log(">>> ABStateManager, initialFileName:", this.initialFileName, "initRet:", ret);
    if (ret)
      this.setStateEffects();
    let script_el = document.querySelector('script[script-id="ab-markmap-script"]');
    if (script_el)
      script_el.remove();
    script_el = document.createElement("script");
    document.head.appendChild(script_el);
    script_el.type = "module";
    script_el.setAttribute("script-id", "ab-markmap-script");
    script_el.textContent = `
    import { Markmap, } from 'https://jspm.dev/markmap-view';
    const mindmaps = document.querySelectorAll('.ab-markmap-svg'); // \u6CE8\u610F\u4E00\u4E0B\u8FD9\u91CC\u7684\u9009\u62E9\u5668
    for(const mindmap of mindmaps) {
      Markmap.create(mindmap,null,JSON.parse(mindmap.getAttribute('data-json')));
    }`;
  }
  get cursor() {
    return this.editor.getCursor();
  }
  get state() {
    return this.view.getState();
  }
  get mdText() {
    return this.editor.getValue();
  }
  destructor() {
    console.log("<<< ABStateManager, initialFileName:", this.initialFileName);
  }
  init() {
    const view = this.plugin_this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!view)
      return false;
    this.view = view;
    this.initialFileName = this.view.file.basename;
    this.editor = this.view.editor;
    this.editorView = this.editor.cm;
    this.editorState = this.editorView.state;
    this.is_prev_cursor_in = true;
    this.prev_decoration_mode = "none" /* none */;
    this.prev_editor_mode = 0 /* NONE */;
    return true;
  }
  setStateEffects() {
    let stateEffects = [];
    if (!this.editorState.field(this.decorationField, false)) {
      stateEffects.push(import_state.StateEffect.appendConfig.of([this.decorationField]));
      stateEffects.push(import_state.StateEffect.appendConfig.of([ABDecorationManager.decoration_theme()]));
    }
    this.editorView.dispatch({ effects: stateEffects });
    return true;
  }
  updateStateField(decorationSet, tr) {
    let editor_mode = this.getEditorMode();
    let decoration_mode;
    if (editor_mode == 1 /* SOURCE */) {
      decoration_mode = this.plugin_this.settings.decoration_source;
    } else if (editor_mode == 2 /* SOURCE_LIVE */) {
      decoration_mode = this.plugin_this.settings.decoration_live;
    } else {
      decoration_mode = this.plugin_this.settings.decoration_render;
    }
    return this.refreshStrong2(decorationSet, tr, decoration_mode, editor_mode);
  }
  getEditorMode() {
    let editor_dom;
    editor_dom = this.plugin_this.app.workspace.activeLeaf.containerEl;
    if (!editor_dom) {
      console.warn("\u65E0\u6CD5\u83B7\u53D6dom\u6765\u5F97\u77E5\u7F16\u8F91\u5668\u6A21\u5F0F");
      return 0 /* NONE */;
    }
    editor_dom = editor_dom == null ? void 0 : editor_dom.getElementsByClassName("workspace-leaf-content")[0];
    let str = editor_dom == null ? void 0 : editor_dom.getAttribute("data-mode");
    if (str == "source") {
      editor_dom = editor_dom == null ? void 0 : editor_dom.getElementsByClassName("markdown-source-view")[0];
      if (editor_dom == null ? void 0 : editor_dom.classList.contains("is-live-preview"))
        return 2 /* SOURCE_LIVE */;
      else
        return 1 /* SOURCE */;
    } else if (str == "preview") {
      return 3 /* PREVIEW */;
    } else {
      return 0 /* NONE */;
    }
  }
  getCursorCh() {
    let cursor_from_ch = 0;
    let cursor_to_ch = 0;
    let list_text = this.editor.getValue().split("\n");
    for (let i = 0; i <= this.editor.getCursor("to").line; i++) {
      if (this.editor.getCursor("from").line == i) {
        cursor_from_ch = cursor_to_ch + this.editor.getCursor("from").ch;
      }
      if (this.editor.getCursor("to").line == i) {
        cursor_to_ch = cursor_to_ch + this.editor.getCursor("to").ch;
        break;
      }
      cursor_to_ch += list_text[i].length + 1;
    }
    return {
      from: cursor_from_ch,
      to: cursor_to_ch
    };
  }
  refreshStrong2(decorationSet, tr, decoration_mode, editor_mode) {
    let is_current_cursor_in = false;
    if (decoration_mode == "none" /* none */) {
      if (decoration_mode != this.prev_decoration_mode) {
        decorationSet = decorationSet.update({
          filter: (from, to, value) => {
            return false;
          }
        });
        this.is_prev_cursor_in = true;
        this.prev_decoration_mode = decoration_mode;
        this.prev_editor_mode = editor_mode;
        return decorationSet;
      } else {
        return decorationSet;
      }
    }
    let list_add_decoration = [];
    const list_rangeSpec = autoMdSelector(this.mdText);
    for (let rangeSpec of list_rangeSpec) {
      let decoration;
      const cursorSpec = this.getCursorCh();
      if (cursorSpec.from >= rangeSpec.from_ch && cursorSpec.from <= rangeSpec.to_ch || cursorSpec.to >= rangeSpec.from_ch && cursorSpec.to <= rangeSpec.to_ch) {
        decoration = import_view3.Decoration.mark({ class: "ab-line-yellow" });
        is_current_cursor_in = true;
      } else {
        decoration = import_view3.Decoration.replace({ widget: new ABReplacer_Widget(rangeSpec, this.editor) });
      }
      list_add_decoration.push(decoration.range(rangeSpec.from_ch, rangeSpec.to_ch));
    }
    if (is_current_cursor_in != this.is_prev_cursor_in || decoration_mode != this.prev_decoration_mode || editor_mode != this.prev_editor_mode) {
      this.is_prev_cursor_in = is_current_cursor_in;
      this.prev_decoration_mode = decoration_mode;
      this.prev_editor_mode = editor_mode;
      decorationSet = decorationSet.update({
        filter: (from, to, value) => {
          return false;
        }
      });
      for (let item of list_add_decoration) {
        decorationSet = decorationSet.update({
          add: [item]
        });
      }
    }
    decorationSet = decorationSet.map(tr.changes);
    return decorationSet;
  }
};

// src/ab_manager/abm_html/ABSelector_PostHtml.ts
var import_html_to_md = __toESM(require_dist());

// src/ab_manager/abm_html/ABReplacer_Render.ts
var import_obsidian4 = require("obsidian");
var ABReplacer_Render = class extends import_obsidian4.MarkdownRenderChild {
  constructor(containerEl, header, content, selectorName = "replacer_default") {
    super(containerEl);
    this.header = header;
    this.content = content;
    this.selectorName = selectorName;
  }
  onload() {
    const div = this.containerEl.createDiv({
      cls: ["ab-replace", "cm-embed-block"]
    });
    div.setAttribute("type_header", this.header);
    const dom_note = div.createDiv({
      cls: ["ab-note", "drop-shadow"]
    });
    let dom_replaceEl = dom_note.createDiv({
      cls: ["ab-replaceEl"]
    });
    ABConvertManager.autoABConvert(dom_replaceEl, this.header, this.content, this.selectorName);
    this.containerEl.replaceWith(div);
    const dom_edit = div.createEl("select", {
      cls: ["ab-button", "edit-block-button"],
      attr: { "aria-label": "Edit this block - " + this.header }
    });
    const first_dom_option = dom_edit.createEl("option", {
      text: "\u590D\u5408\u683C\u5F0F:" + this.header,
      attr: { "value": this.header }
    });
    first_dom_option.selected = true;
    let header_name_flag = "";
    for (let item of ABConvertManager.getInstance().getConvertOptions()) {
      const dom_option = dom_edit.createEl("option", {
        text: item.name,
        attr: { "value": item.id }
      });
      if (this.header == item.id) {
        header_name_flag = item.name;
      }
    }
    if (header_name_flag != "") {
      first_dom_option.setText(header_name_flag);
    }
    dom_edit.onchange = () => {
      const new_header = dom_edit.options[dom_edit.selectedIndex].value;
      const new_dom_replaceEl = dom_note.createDiv({
        cls: ["ab-replaceEl"]
      });
      ABConvertManager.autoABConvert(new_dom_replaceEl, new_header, this.content, this.selectorName);
      dom_replaceEl.replaceWith(new_dom_replaceEl);
      dom_replaceEl = new_dom_replaceEl;
    };
    const button_show = () => {
      dom_edit.show();
    };
    const button_hide = () => {
      dom_edit.hide();
    };
    dom_edit.hide();
    dom_note.onmouseover = button_show;
    dom_note.onmouseout = button_hide;
    dom_edit.onmouseover = button_show;
    dom_edit.onmouseout = button_hide;
  }
};
ABReplacer_Render.str_icon_code2 = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-darkreader-inline-stroke="" style="--darkreader-inline-stroke:currentColor;"><path d="m18 16 4-4-4-4"></path><path d="m6 8-4 4 4 4"></path><path d="m14.5 4-5 16"></path></svg>`;

// src/ab_manager/abm_html/ABSelector_PostHtml.ts
var import_assert = require("assert");
var last_el;
var last_mdSrc;
var ABSelector_PostHtml = class {
  static processor(el, ctx) {
    if (this.settings.decoration_render == "none" /* none */)
      return;
    const mdSrc = getSourceMarkdown(el, ctx);
    if (!mdSrc) {
      if (!el.classList.contains("markdown-rendered"))
        return;
      findABBlock_recurve(el);
    } else {
      for (const subEl of el.children) {
        findABBlock_cross(subEl, ctx);
      }
      last_el = el;
      last_mdSrc = mdSrc;
    }
  }
};
function findABBlock_recurve(targetEl) {
  var _a;
  for (let i = 0; i < targetEl.children.length; i++) {
    const contentEl = targetEl.children[i];
    if (!(contentEl instanceof HTMLUListElement || contentEl instanceof HTMLQuoteElement || contentEl instanceof HTMLPreElement || contentEl instanceof HTMLTableElement))
      continue;
    const headerEl = i == 0 ? null : targetEl.children[i - 1];
    if (i == 0 || !(headerEl instanceof HTMLParagraphElement)) {
      if (contentEl instanceof HTMLUListElement || contentEl instanceof HTMLQuoteElement)
        findABBlock_recurve(contentEl);
      continue;
    }
    const header_match = headerEl.getText().match(ABReg5.reg_header);
    if (!header_match) {
      if (contentEl instanceof HTMLUListElement || contentEl instanceof HTMLQuoteElement)
        findABBlock_recurve(contentEl);
      continue;
    }
    const header_str = header_match[5];
    const newEl = document.createElement("div");
    newEl.addClass("ab-re-rendered");
    (_a = headerEl.parentNode) == null ? void 0 : _a.insertBefore(newEl, headerEl.nextSibling);
    ABConvertManager.autoABConvert(newEl, header_str, (0, import_html_to_md.default)(contentEl.innerHTML), "postHtml");
    contentEl.hide();
    headerEl.hide();
  }
}
function findABBlock_cross(targetEl, ctx) {
  if (targetEl instanceof HTMLUListElement || targetEl instanceof HTMLQuoteElement || targetEl instanceof HTMLPreElement || targetEl instanceof HTMLTableElement) {
    replaceABBlock(targetEl, ctx);
  }
  function replaceABBlock(targetEl2, ctx2) {
    const range = getSourceMarkdown(targetEl2, ctx2);
    if (!range || !range.header)
      return false;
    if (range.selector == "list") {
      if (range.header.indexOf("2") == 0)
        range.header = "list" + range.header;
    }
    ctx2.addChild(new ABReplacer_Render(targetEl2, range.header, range.content, range.selector));
    last_el.hide();
  }
}
function getSourceMarkdown(sectionEl, ctx) {
  let info = ctx.getSectionInfo(sectionEl);
  if (info) {
    let range = {
      from_line: 0,
      to_line: 1,
      header: "",
      selector: "none",
      content: "",
      prefix: ""
    };
    const { text, lineStart, lineEnd } = info;
    const list_text = text.replace(/(\s*$)/g, "").split("\n");
    const list_content = list_text.slice(lineStart, lineEnd + 1);
    range.from_line = lineStart;
    range.to_line = lineEnd + 1;
    range.content = list_content.join("\n");
    if (sectionEl instanceof HTMLUListElement) {
      range.selector = "list";
      const match2 = list_content[0].match(ABReg5.reg_list);
      if (!match2)
        return range;
      else
        range.prefix = match2[1];
    } else if (sectionEl instanceof HTMLQuoteElement) {
      range.selector = "quote";
      const match2 = list_content[0].match(ABReg5.reg_quote);
      if (!match2)
        return range;
      else
        range.prefix = match2[1];
    } else if (sectionEl instanceof HTMLPreElement) {
      range.selector = "code";
      const match2 = list_content[0].match(ABReg5.reg_code);
      if (!match2)
        return range;
      else
        range.prefix = match2[1];
    } else if (sectionEl instanceof HTMLHeadingElement) {
      range.selector = "heading";
      const match2 = list_content[0].match(ABReg5.reg_heading);
      if (!match2)
        return range;
      else
        range.prefix = match2[1];
    } else if (sectionEl instanceof HTMLTableElement) {
      range.selector = "table";
      const match2 = list_content[0].match(ABReg5.reg_table);
      if (!match2)
        return range;
      else
        range.prefix = match2[1];
    }
    let match_header;
    if (lineStart == 0) {
      return range;
    } else if (lineStart > 2 && list_text[lineStart - 1].trim() == "") {
      if (list_text[lineStart - 2].indexOf(range.prefix) != 0)
        return range;
      match_header = list_text[lineStart - 2].replace(range.prefix, "").match(ABReg5.reg_header);
    } else {
      if (lineStart > 1 && list_text[lineStart - 1].indexOf(range.prefix) != 0 && list_text[lineStart - 1].trim() == "")
        return range;
      match_header = list_text[lineStart - 1].replace(range.prefix, "").match(ABReg5.reg_header);
    }
    if (!match_header)
      return range;
    range.header = match_header[5];
    return range;
  }
  return null;
}

// src/main.ts
var AnyBlockPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new ABSettingTab(this.app, this));
    ABConvertManager.getInstance().redefine_renderMarkdown((markdown, el) => {
      import_obsidian6.MarkdownRenderer.render(app, markdown, el, "", new import_obsidian6.MarkdownRenderChild(el));
    });
    this.registerMarkdownCodeBlockProcessor("ab", ABReplacer_CodeBlock.processor);
    {
      let abm;
      this.app.workspace.onLayoutReady(() => {
        abm == null ? void 0 : abm.destructor();
        abm = new ABStateManager(this);
      });
      this.registerEvent(this.app.workspace.on("file-open", (fileObj) => {
        abm == null ? void 0 : abm.destructor();
        abm = new ABStateManager(this);
      }));
      this.registerEvent(this.app.workspace.on("layout-change", () => {
        abm == null ? void 0 : abm.destructor();
        abm = new ABStateManager(this);
      }));
    }
    const htmlProcessor = ABSelector_PostHtml.processor.bind(this);
    this.registerMarkdownPostProcessor(htmlProcessor);
  }
  async loadSettings() {
    this.settings = Object.assign({}, AB_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  onunload() {
  }
};
